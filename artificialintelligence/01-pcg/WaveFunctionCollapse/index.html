<!doctype html><html lang=en class=no-js> <head><meta charset=utf-8><meta name=viewport content="width=device-width,initial-scale=1"><meta name=description content="Awesome GameDev Resources for learning how to make games"><meta name=author content="See contributors and authors at https://github.com/InfiniBrains/Awesome-GameDev-Resources/graphs/contributors"><link href=https://courses.tolstenko.net/artificialintelligence/01-pcg/WaveFunctionCollapse/ rel=canonical><link href=../../06-pathfinding/ rel=prev><link href=../HydraulicErosion/ rel=next><link rel=alternate type=application/rss+xml title="RSS feed" href=../../../feed_rss_created.xml><link rel=alternate type=application/rss+xml title="RSS feed of updated content" href=../../../feed_rss_updated.xml><link rel=icon href=../../../assets/logo.png><meta name=generator content="mkdocs-1.6.1, mkdocs-material-9.5.44+insiders-4.53.14"><title>Wave Function Collapse - Awesome GameDev Resources</title><link rel=stylesheet href=../../../assets/stylesheets/main.12320a83.min.css><link rel=stylesheet href=../../../assets/stylesheets/palette.ab4e12ef.min.css><link rel=preconnect href=https://fonts.gstatic.com crossorigin><link rel=stylesheet href="https://fonts.googleapis.com/css?family=Roboto:300,300i,400,400i,700,700i%7CRoboto+Mono:400,400i,700,700i&display=fallback"><style>:root{--md-text-font:"Roboto";--md-code-font:"Roboto Mono"}</style><script>__md_scope=new URL("../../..",location),__md_hash=e=>[...e].reduce(((e,_)=>(e<<5)-e+_.charCodeAt(0)),0),__md_get=(e,_=localStorage,t=__md_scope)=>JSON.parse(_.getItem(t.pathname+"."+e)),__md_set=(e,_,t=localStorage,a=__md_scope)=>{try{t.setItem(a.pathname+"."+e,JSON.stringify(_))}catch(e){}}</script><script id=__analytics>function __md_analytics(){function e(){dataLayer.push(arguments)}window.dataLayer=window.dataLayer||[],e("js",new Date),e("config","G-347541715"),document.addEventListener("DOMContentLoaded",(function(){document.forms.search&&document.forms.search.query.addEventListener("blur",(function(){this.value&&e("event","search",{search_term:this.value})}));document$.subscribe((function(){var t=document.forms.feedback;if(void 0!==t)for(var a of t.querySelectorAll("[type=submit]"))a.addEventListener("click",(function(a){a.preventDefault();var n=document.location.pathname,d=this.getAttribute("data-md-value");e("event","feedback",{page:n,data:d}),t.firstElementChild.disabled=!0;var r=t.querySelector(".md-feedback__note [data-md-value='"+d+"']");r&&(r.hidden=!1)})),t.hidden=!1})),location$.subscribe((function(t){e("config","G-347541715",{page_path:t.pathname})}))}));var t=document.createElement("script");t.async=!0,t.src="https://www.googletagmanager.com/gtag/js?id=G-347541715",document.getElementById("__analytics").insertAdjacentElement("afterEnd",t)}</script><script>if("undefined"!=typeof __md_analytics){var consent=__md_get("__consent");consent&&consent.analytics&&__md_analytics()}</script><meta property=og:type content=website><meta property=og:title content="Wave Function Collapse - Awesome GameDev Resources"><meta property=og:description content="Awesome GameDev Resources for learning how to make games"><meta property=og:image content=https://courses.tolstenko.net/assets/images/social/artificialintelligence/01-pcg/WaveFunctionCollapse.png><meta property=og:image:type content=image/png><meta property=og:image:width content=1200><meta property=og:image:height content=630><meta content=https://courses.tolstenko.net/artificialintelligence/01-pcg/WaveFunctionCollapse/ property=og:url><meta property=twitter:card content=summary_large_image><meta property=twitter:title content="Wave Function Collapse - Awesome GameDev Resources"><meta property=twitter:description content="Awesome GameDev Resources for learning how to make games"><meta property=twitter:image content=https://courses.tolstenko.net/assets/images/social/artificialintelligence/01-pcg/WaveFunctionCollapse.png> <link href="../../../assets/stylesheets/glightbox.min.css" rel="stylesheet"/><style>
    html.glightbox-open { overflow: initial; height: 100%; }
    .gslide-title { margin-top: 0px; user-select: text; }
    .gslide-desc { color: #666; user-select: text; }
    .gslide-image img { background: white; }
    .gscrollbar-fixer { padding-right: 15px; }
    .gdesc-inner { font-size: 0.75rem; }
    body[data-md-color-scheme="slate"] .gdesc-inner { background: var(--md-default-bg-color);}
    body[data-md-color-scheme="slate"] .gslide-title { color: var(--md-default-fg-color);}
    body[data-md-color-scheme="slate"] .gslide-desc { color: var(--md-default-fg-color);}</style> <script src="../../../assets/javascripts/glightbox.min.js"></script></head> <body dir=ltr data-md-color-scheme=default data-md-color-primary=indigo data-md-color-accent=indigo> <input class=md-toggle data-md-toggle=drawer type=checkbox id=__drawer autocomplete=off> <input class=md-toggle data-md-toggle=search type=checkbox id=__search autocomplete=off> <label class=md-overlay for=__drawer></label> <div data-md-component=skip> <a href=#wave-function-collapse-wfc-for-games class=md-skip> Skip to content </a> </div> <div data-md-component=announce> </div> <header class=md-header data-md-component=header> <nav class="md-header__inner md-grid" aria-label=Header> <a href=../../.. title="Awesome GameDev Resources" class="md-header__button md-logo" aria-label="Awesome GameDev Resources" data-md-component=logo> <img src=../../../assets/logo.png alt=logo> </a> <label class="md-header__button md-icon" for=__drawer> <svg xmlns=http://www.w3.org/2000/svg viewbox="0 0 24 24"><path d="M3 6h18v2H3zm0 5h18v2H3zm0 5h18v2H3z"/></svg> </label> <div class=md-header__title data-md-component=header-title> <div class=md-header__ellipsis> <div class=md-header__topic> <span class=md-ellipsis> Awesome GameDev Resources </span> </div> <div class=md-header__topic data-md-component=header-topic> <span class=md-ellipsis> Wave Function Collapse </span> </div> </div> </div> <form class=md-header__option data-md-component=palette> <input class=md-option data-md-color-media=(prefers-color-scheme) data-md-color-scheme=default data-md-color-primary=indigo data-md-color-accent=indigo aria-label="Switch to light mode" type=radio name=__palette id=__palette_0> <label class="md-header__button md-icon" title="Switch to light mode" for=__palette_1 hidden> <svg xmlns=http://www.w3.org/2000/svg viewbox="0 0 24 24"><path d="m14.3 16-.7-2h-3.2l-.7 2H7.8L11 7h2l3.2 9zM20 8.69V4h-4.69L12 .69 8.69 4H4v4.69L.69 12 4 15.31V20h4.69L12 23.31 15.31 20H20v-4.69L23.31 12zm-9.15 3.96h2.3L12 9z"/></svg> </label> <input class=md-option data-md-color-media="(prefers-color-scheme: light)" data-md-color-scheme=default data-md-color-primary=indigo data-md-color-accent=indigo aria-label="Switch to dark mode" type=radio name=__palette id=__palette_1> <label class="md-header__button md-icon" title="Switch to dark mode" for=__palette_2 hidden> <svg xmlns=http://www.w3.org/2000/svg viewbox="0 0 24 24"><path d="M12 8a4 4 0 0 0-4 4 4 4 0 0 0 4 4 4 4 0 0 0 4-4 4 4 0 0 0-4-4m0 10a6 6 0 0 1-6-6 6 6 0 0 1 6-6 6 6 0 0 1 6 6 6 6 0 0 1-6 6m8-9.31V4h-4.69L12 .69 8.69 4H4v4.69L.69 12 4 15.31V20h4.69L12 23.31 15.31 20H20v-4.69L23.31 12z"/></svg> </label> <input class=md-option data-md-color-media="(prefers-color-scheme: dark)" data-md-color-scheme=slate data-md-color-primary=indigo data-md-color-accent=indigo aria-label="Switch to system preference" type=radio name=__palette id=__palette_2> <label class="md-header__button md-icon" title="Switch to system preference" for=__palette_0 hidden> <svg xmlns=http://www.w3.org/2000/svg viewbox="0 0 24 24"><path d="M12 18c-.89 0-1.74-.2-2.5-.55C11.56 16.5 13 14.42 13 12s-1.44-4.5-3.5-5.45C10.26 6.2 11.11 6 12 6a6 6 0 0 1 6 6 6 6 0 0 1-6 6m8-9.31V4h-4.69L12 .69 8.69 4H4v4.69L.69 12 4 15.31V20h4.69L12 23.31 15.31 20H20v-4.69L23.31 12z"/></svg> </label> </form> <script>var palette=__md_get("__palette");if(palette&&palette.color){if("(prefers-color-scheme)"===palette.color.media){var media=matchMedia("(prefers-color-scheme: light)"),input=document.querySelector(media.matches?"[data-md-color-media='(prefers-color-scheme: light)']":"[data-md-color-media='(prefers-color-scheme: dark)']");palette.color.media=input.getAttribute("data-md-color-media"),palette.color.scheme=input.getAttribute("data-md-color-scheme"),palette.color.primary=input.getAttribute("data-md-color-primary"),palette.color.accent=input.getAttribute("data-md-color-accent")}for(var[key,value]of Object.entries(palette.color))document.body.setAttribute("data-md-color-"+key,value)}</script> <label class="md-header__button md-icon" for=__search> <svg xmlns=http://www.w3.org/2000/svg viewbox="0 0 24 24"><path d="M9.5 3A6.5 6.5 0 0 1 16 9.5c0 1.61-.59 3.09-1.56 4.23l.27.27h.79l5 5-1.5 1.5-5-5v-.79l-.27-.27A6.52 6.52 0 0 1 9.5 16 6.5 6.5 0 0 1 3 9.5 6.5 6.5 0 0 1 9.5 3m0 2C7 5 5 7 5 9.5S7 14 9.5 14 14 12 14 9.5 12 5 9.5 5"/></svg> </label> <div class=md-search data-md-component=search role=dialog> <label class=md-search__overlay for=__search></label> <div class=md-search__inner role=search> <form class=md-search__form name=search> <input type=text class=md-search__input name=query aria-label=Search placeholder=Search autocapitalize=off autocorrect=off autocomplete=off spellcheck=false data-md-component=search-query required> <label class="md-search__icon md-icon" for=__search> <svg xmlns=http://www.w3.org/2000/svg viewbox="0 0 24 24"><path d="M9.5 3A6.5 6.5 0 0 1 16 9.5c0 1.61-.59 3.09-1.56 4.23l.27.27h.79l5 5-1.5 1.5-5-5v-.79l-.27-.27A6.52 6.52 0 0 1 9.5 16 6.5 6.5 0 0 1 3 9.5 6.5 6.5 0 0 1 9.5 3m0 2C7 5 5 7 5 9.5S7 14 9.5 14 14 12 14 9.5 12 5 9.5 5"/></svg> <svg xmlns=http://www.w3.org/2000/svg viewbox="0 0 24 24"><path d="M20 11v2H8l5.5 5.5-1.42 1.42L4.16 12l7.92-7.92L13.5 5.5 8 11z"/></svg> </label> <nav class=md-search__options aria-label=Search> <a href=javascript:void(0) class="md-search__icon md-icon" title=Share aria-label=Share data-clipboard data-clipboard-text data-md-component=search-share tabindex=-1> <svg xmlns=http://www.w3.org/2000/svg viewbox="0 0 24 24"><path d="M18 16.08c-.76 0-1.44.3-1.96.77L8.91 12.7c.05-.23.09-.46.09-.7s-.04-.47-.09-.7l7.05-4.11c.54.5 1.25.81 2.04.81a3 3 0 0 0 3-3 3 3 0 0 0-3-3 3 3 0 0 0-3 3c0 .24.04.47.09.7L8.04 9.81C7.5 9.31 6.79 9 6 9a3 3 0 0 0-3 3 3 3 0 0 0 3 3c.79 0 1.5-.31 2.04-.81l7.12 4.15c-.05.21-.08.43-.08.66 0 1.61 1.31 2.91 2.92 2.91s2.92-1.3 2.92-2.91A2.92 2.92 0 0 0 18 16.08"/></svg> </a> <button type=reset class="md-search__icon md-icon" title=Clear aria-label=Clear tabindex=-1> <svg xmlns=http://www.w3.org/2000/svg viewbox="0 0 24 24"><path d="M19 6.41 17.59 5 12 10.59 6.41 5 5 6.41 10.59 12 5 17.59 6.41 19 12 13.41 17.59 19 19 17.59 13.41 12z"/></svg> </button> </nav> <div class=md-search__suggest data-md-component=search-suggest></div> </form> <div class=md-search__output> <div class=md-search__scrollwrap tabindex=0 data-md-scrollfix> <div class=md-search-result data-md-component=search-result> <div class=md-search-result__meta> Initializing search </div> <ol class=md-search-result__list role=presentation></ol> </div> </div> </div> </div> </div> <div class=md-header__source> <a href=https://github.com/InfiniBrains/Awesome-GameDev-Resources title="Go to repository" class=md-source data-md-component=source> <div class="md-source__icon md-icon"> <svg xmlns=http://www.w3.org/2000/svg viewbox="0 0 448 512"><!-- Font Awesome Free 6.6.0 by @fontawesome - https://fontawesome.com License - https://fontawesome.com/license/free (Icons: CC BY 4.0, Fonts: SIL OFL 1.1, Code: MIT License) Copyright 2024 Fonticons, Inc.--><path d="M439.55 236.05 244 40.45a28.87 28.87 0 0 0-40.81 0l-40.66 40.63 51.52 51.52c27.06-9.14 52.68 16.77 43.39 43.68l49.66 49.66c34.23-11.8 61.18 31 35.47 56.69-26.49 26.49-70.21-2.87-56-37.34L240.22 199v121.85c25.3 12.54 22.26 41.85 9.08 55a34.34 34.34 0 0 1-48.55 0c-17.57-17.6-11.07-46.91 11.25-56v-123c-20.8-8.51-24.6-30.74-18.64-45L142.57 101 8.45 235.14a28.86 28.86 0 0 0 0 40.81l195.61 195.6a28.86 28.86 0 0 0 40.8 0l194.69-194.69a28.86 28.86 0 0 0 0-40.81"/></svg> </div> <div class=md-source__repository> InfiniBrains/Awesome-GameDev-Resources </div> </a> </div> </nav> </header> <div class=md-container data-md-component=container> <nav class=md-tabs aria-label=Tabs data-md-component=tabs> <div class=md-grid> <ul class=md-tabs__list> <li class=md-tabs__item> <a href=../../.. class=md-tabs__link> Home </a> </li> <li class=md-tabs__item> <a href=../../../introgameprog/ class=md-tabs__link> Intro. Game Programming </a> </li> <li class="md-tabs__item md-tabs__item--active"> <a href=../../ class=md-tabs__link> AI </a> </li> <li class=md-tabs__item> <a href=../../../intro/ class=md-tabs__link> Intro. Programming </a> </li> <li class=md-tabs__item> <a href=../../../advanced/ class=md-tabs__link> Adv. Programming </a> </li> <li class=md-tabs__item> <a href=../../../algorithms/ class=md-tabs__link> Algorithms </a> </li> <li class=md-tabs__item> <a href=../../../portfolio/ class=md-tabs__link> Portfolio </a> </li> <li class=md-tabs__item> <a href=../../../blog/ class=md-tabs__link> Blog </a> </li> <li class=md-tabs__item> <a href=../../../support/50rs-button/ class=md-tabs__link> Support </a> </li> </ul> </div> </nav> <main class=md-main data-md-component=main> <div class="md-main__inner md-grid"> <div class="md-sidebar md-sidebar--primary" data-md-component=sidebar data-md-type=navigation> <div class=md-sidebar__scrollwrap> <div class=md-sidebar__inner> <nav class="md-nav md-nav--primary md-nav--lifted md-nav--integrated" aria-label=Navigation data-md-level=0> <label class=md-nav__title for=__drawer> <a href=../../.. title="Awesome GameDev Resources" class="md-nav__button md-logo" aria-label="Awesome GameDev Resources" data-md-component=logo> <img src=../../../assets/logo.png alt=logo> </a> Awesome GameDev Resources </label> <div class=md-nav__source> <a href=https://github.com/InfiniBrains/Awesome-GameDev-Resources title="Go to repository" class=md-source data-md-component=source> <div class="md-source__icon md-icon"> <svg xmlns=http://www.w3.org/2000/svg viewbox="0 0 448 512"><!-- Font Awesome Free 6.6.0 by @fontawesome - https://fontawesome.com License - https://fontawesome.com/license/free (Icons: CC BY 4.0, Fonts: SIL OFL 1.1, Code: MIT License) Copyright 2024 Fonticons, Inc.--><path d="M439.55 236.05 244 40.45a28.87 28.87 0 0 0-40.81 0l-40.66 40.63 51.52 51.52c27.06-9.14 52.68 16.77 43.39 43.68l49.66 49.66c34.23-11.8 61.18 31 35.47 56.69-26.49 26.49-70.21-2.87-56-37.34L240.22 199v121.85c25.3 12.54 22.26 41.85 9.08 55a34.34 34.34 0 0 1-48.55 0c-17.57-17.6-11.07-46.91 11.25-56v-123c-20.8-8.51-24.6-30.74-18.64-45L142.57 101 8.45 235.14a28.86 28.86 0 0 0 0 40.81l195.61 195.6a28.86 28.86 0 0 0 40.8 0l194.69-194.69a28.86 28.86 0 0 0 0-40.81"/></svg> </div> <div class=md-source__repository> InfiniBrains/Awesome-GameDev-Resources </div> </a> </div> <ul class=md-nav__list data-md-scrollfix> <li class=md-nav__item> <a href=../../.. class=md-nav__link> <span class=md-ellipsis> Home </span> </a> </li> <li class="md-nav__item md-nav__item--pruned md-nav__item--nested"> <a href=../../../introgameprog/ class=md-nav__link> <span class=md-ellipsis> Intro. Game Programming </span> <span class="md-nav__icon md-icon"></span> </a> </li> <li class="md-nav__item md-nav__item--active md-nav__item--section md-nav__item--nested"> <input class="md-nav__toggle md-toggle " type=checkbox id=__nav_3 checked> <div class="md-nav__link md-nav__container"> <a href=../../ class="md-nav__link "> <span class=md-ellipsis> AI </span> </a> <label class="md-nav__link " for=__nav_3 id=__nav_3_label tabindex> <span class="md-nav__icon md-icon"></span> </label> </div> <nav class=md-nav data-md-level=1 aria-labelledby=__nav_3_label aria-expanded=true> <label class=md-nav__title for=__nav_3> <span class="md-nav__icon md-icon"></span> AI </label> <ul class=md-nav__list data-md-scrollfix> <li class=md-nav__item> <a href=../../readings/spatial-quantization/ class=md-nav__link> <span class=md-ellipsis> Spatial Quantization </span> </a> </li> <li class=md-nav__item> <a href=../../04-spatialhashing/ class=md-nav__link> <span class=md-ellipsis> Spatial Hashing </span> </a> </li> <li class=md-nav__item> <a href=../../05-kdtree/ class=md-nav__link> <span class=md-ellipsis> KD-Tree </span> </a> </li> <li class=md-nav__item> <a href=../../06-pathfinding/ class=md-nav__link> <span class=md-ellipsis> Pathfinding </span> </a> </li> <li class="md-nav__item md-nav__item--active"> <input class="md-nav__toggle md-toggle" type=checkbox id=__toc> <label class="md-nav__link md-nav__link--active" for=__toc> <span class=md-ellipsis> Wave Function Collapse </span> <span class="md-nav__icon md-icon"></span> </label> <a href=./ class="md-nav__link md-nav__link--active"> <span class=md-ellipsis> Wave Function Collapse </span> </a> <nav class="md-nav md-nav--secondary" aria-label="Table of contents"> <label class=md-nav__title for=__toc> <span class="md-nav__icon md-icon"></span> Table of contents </label> <ul class=md-nav__list data-md-component=toc data-md-scrollfix> <li class=md-nav__item> <a href=#wfc-in-a-nutshell class=md-nav__link> <span class=md-ellipsis> WFC in a Nutshell 🥜 </span> </a> </li> <li class=md-nav__item> <a href=#key-concepts-of-wfc class=md-nav__link> <span class=md-ellipsis> Key Concepts of WFC 🤓 </span> </a> <nav class=md-nav aria-label="Key Concepts of WFC 🤓"> <ul class=md-nav__list> <li class=md-nav__item> <a href=#superposition-no-youre-not-in-physics-class class=md-nav__link> <span class=md-ellipsis> Superposition (No, You’re Not in Physics Class) </span> </a> </li> <li class=md-nav__item> <a href=#adjacency-constraints-the-you-shall-not-pass-rules class=md-nav__link> <span class=md-ellipsis> Adjacency Constraints: The “You Shall Not Pass” Rules 🚧 </span> </a> </li> <li class=md-nav__item> <a href=#entropy-the-hot-mess-meter class=md-nav__link> <span class=md-ellipsis> Entropy: The "Hot Mess" Meter 🔥 </span> </a> </li> <li class=md-nav__item> <a href=#backtracking-undo-like-a-pro class=md-nav__link> <span class=md-ellipsis> Backtracking: Undo Like a Pro ⏪ </span> </a> </li> </ul> </nav> </li> <li class=md-nav__item> <a href=#where-can-you-use-wfc-in-games class=md-nav__link> <span class=md-ellipsis> Where Can You Use WFC in Games? 🎮 </span> </a> <nav class=md-nav aria-label="Where Can You Use WFC in Games? 🎮"> <ul class=md-nav__list> <li class=md-nav__item> <a href=#1-procedural-level-generation class=md-nav__link> <span class=md-ellipsis> 1. Procedural Level Generation 🌍 </span> </a> </li> <li class=md-nav__item> <a href=#2-texture-synthesis class=md-nav__link> <span class=md-ellipsis> 2. Texture Synthesis 🎨 </span> </a> </li> <li class=md-nav__item> <a href=#3-tiling-based-puzzle-games class=md-nav__link> <span class=md-ellipsis> 3. Tiling-Based Puzzle Games 🧩 </span> </a> </li> <li class=md-nav__item> <a href=#4-story-or-quest-generation class=md-nav__link> <span class=md-ellipsis> 4. Story or Quest Generation 📜 </span> </a> </li> </ul> </nav> </li> <li class=md-nav__item> <a href=#how-to-implement-wfc-in-games class=md-nav__link> <span class=md-ellipsis> How to Implement WFC in Games 🚀 </span> </a> <nav class=md-nav aria-label="How to Implement WFC in Games 🚀"> <ul class=md-nav__list> <li class=md-nav__item> <a href=#step-1-define-your-tile-set class=md-nav__link> <span class=md-ellipsis> Step 1: Define Your Tile Set </span> </a> </li> <li class=md-nav__item> <a href=#step-2-set-up-the-grid-and-superposition class=md-nav__link> <span class=md-ellipsis> Step 2: Set Up the Grid and Superposition </span> </a> </li> <li class=md-nav__item> <a href=#step-3-collapse-based-on-entropy class=md-nav__link> <span class=md-ellipsis> Step 3: Collapse Based on Entropy </span> </a> </li> <li class=md-nav__item> <a href=#step-4-propagate-constraints class=md-nav__link> <span class=md-ellipsis> Step 4: Propagate Constraints </span> </a> </li> <li class=md-nav__item> <a href=#step-5-handle-backtracking class=md-nav__link> <span class=md-ellipsis> Step 5: Handle Backtracking </span> </a> </li> <li class=md-nav__item> <a href=#step-6-optimize-and-iterate class=md-nav__link> <span class=md-ellipsis> Step 6: Optimize and Iterate </span> </a> </li> </ul> </nav> </li> <li class=md-nav__item> <a href=#the-pros-and-cons-of-wfc class=md-nav__link> <span class=md-ellipsis> The Pros and Cons of WFC 🎢 </span> </a> <nav class=md-nav aria-label="The Pros and Cons of WFC 🎢"> <ul class=md-nav__list> <li class=md-nav__item> <a href=#advantages class=md-nav__link> <span class=md-ellipsis> Advantages </span> </a> </li> <li class=md-nav__item> <a href=#challenges class=md-nav__link> <span class=md-ellipsis> Challenges </span> </a> </li> </ul> </nav> </li> <li class=md-nav__item> <a href=#implementation-for-wfc class=md-nav__link> <span class=md-ellipsis> Implementation for WFC 🛠️ </span> </a> </li> <li class=md-nav__item> <a href=#conclusion class=md-nav__link> <span class=md-ellipsis> Conclusion </span> </a> </li> </ul> </nav> </li> <li class=md-nav__item> <a href=../HydraulicErosion/ class=md-nav__link> <span class=md-ellipsis> Hydraulic Erosion </span> </a> </li> <li class=md-nav__item> <a href=../../../blog/2023/10/02/memory-efficient-data-structure-for-procedural-maze-generation/ class=md-nav__link> <span class=md-ellipsis> Memory-efficient Data Structure for Procedural Maze Generation </span> </a> </li> <li class=md-nav__item> <a href=../../07-automatedtesting/ class=md-nav__link> <span class=md-ellipsis> AI for Testing </span> </a> </li> <li class=md-nav__item> <a href=../../09-minmax/ class=md-nav__link> <span class=md-ellipsis> MinMax </span> </a> </li> <li class="md-nav__item md-nav__item--pruned md-nav__item--nested"> <a href=../../assignments/ class=md-nav__link> <span class=md-ellipsis> Assignments </span> <span class="md-nav__icon md-icon"></span> </a> </li> </ul> </nav> </li> <li class="md-nav__item md-nav__item--pruned md-nav__item--nested"> <a href=../../../intro/ class=md-nav__link> <span class=md-ellipsis> Intro. Programming </span> <span class="md-nav__icon md-icon"></span> </a> </li> <li class="md-nav__item md-nav__item--pruned md-nav__item--nested"> <a href=../../../advanced/ class=md-nav__link> <span class=md-ellipsis> Adv. Programming </span> <span class="md-nav__icon md-icon"></span> </a> </li> <li class="md-nav__item md-nav__item--pruned md-nav__item--nested"> <a href=../../../algorithms/ class=md-nav__link> <span class=md-ellipsis> Algorithms </span> <span class="md-nav__icon md-icon"></span> </a> </li> <li class="md-nav__item md-nav__item--pruned md-nav__item--nested"> <a href=../../../portfolio/ class=md-nav__link> <span class=md-ellipsis> Portfolio </span> <span class="md-nav__icon md-icon"></span> </a> </li> <li class="md-nav__item md-nav__item--pruned md-nav__item--nested"> <a href=../../../blog/ class=md-nav__link> <span class=md-ellipsis> Blog </span> <span class="md-nav__icon md-icon"></span> </a> </li> <li class="md-nav__item md-nav__item--pruned md-nav__item--nested"> <a href=../../../support/50rs-button/ class=md-nav__link> <span class=md-ellipsis> Support </span> <span class="md-nav__icon md-icon"></span> </a> </li> </ul> </nav> </div> </div> </div> <div class=md-content data-md-component=content> <nav class=md-path aria-label=Navigation> <ol class=md-path__list> <li class=md-path__item> <a href=../../.. class=md-path__link> <span class=md-ellipsis> Home </span> </a> </li> <li class=md-path__item> <a href=../../ class=md-path__link> <span class=md-ellipsis> AI </span> </a> </li> </ol> </nav> <article class="md-content__inner md-typeset"> <a href=https://github.com/InfiniBrains/Awesome-GameDev-Resources/edit/main/docs/artificialintelligence/01-pcg/WaveFunctionCollapse.md title="Edit this page" class="md-content__button md-icon"> <svg xmlns=http://www.w3.org/2000/svg viewbox="0 0 24 24"><path d="M10 20H6V4h7v5h5v3.1l2-2V8l-6-6H6c-1.1 0-2 .9-2 2v16c0 1.1.9 2 2 2h4zm10.2-7c.1 0 .3.1.4.2l1.3 1.3c.2.2.2.6 0 .8l-1 1-2.1-2.1 1-1c.1-.1.2-.2.4-.2m0 3.9L14.1 23H12v-2.1l6.1-6.1z"/></svg> </a> <h1 id=wave-function-collapse-wfc-for-games>Wave Function Collapse (WFC) for Games<a class=headerlink href=#wave-function-collapse-wfc-for-games title="Permanent link">&para;</a></h1><p style=color:#bdbdbd><i>Estimated time to read: 21 minutes</i></p> <p>Ah, <strong>Wave Function Collapse</strong>—a term that sounds like it belongs in a science fiction novel, but in reality, it's an algorithm with a fancy name that doesn’t really involve any quantum magic. It's widely used in <strong>Procedural Content Generation (PCG)</strong>, a technique that game developers absolutely adore because it makes their lives easier. But don’t let the quantum-themed name fool you—there’s no need for Schrödinger’s cat or any collapsing universes here.</p> <div class="admonition note"> <p class=admonition-title>🚨 <strong>Personal Opinion Alert</strong>:</p> <p>Who came up with this name? Sure, it sounds cool and science-y, but it's about as quantum as my morning coffee. Let’s be real: they chose it because it’s more marketable. 😂</p> </div> <p>In practice, WFC is just about solving constraint satisfaction problems. This magical-sounding technique was brought to the limelight by <a href=https://github.com/mxgmn/WaveFunctionCollapse>Maxim Gumin</a> in 2016. Maxim showed that WFC could generate images and textures following specific rules, and game devs were like, “Yeah, we need that!”</p> <h2 id=wfc-in-a-nutshell>WFC in a Nutshell 🥜<a class=headerlink href=#wfc-in-a-nutshell title="Permanent link">&para;</a></h2> <p>Imagine you have a blank world (a grid, pixels, voxels, whatever). You also have a set of rules about what goes where (e.g., no putting rivers next to mountains). WFC's job is to fill this world, slot by slot, making sure everything sticks to the rules. It's a bit like Sudoku—but instead of numbers, you're dealing with game elements like terrain tiles, rooms, or textures. Easy-peasy, right?</p> <p>Here’s the general rundown:</p> <ul> <li><strong>Sampling the World</strong>: First, create some slots to fill (think of pixels, textures, or rooms in a dungeon).</li> <li><strong>Set the Rules</strong>: Define the constraints for your content—like which tile can sit next to which. No roads to nowhere!</li> <li><strong>Collapse the World</strong>: Start with an empty world and let the algorithm fill in the blanks, one tile at a time, according to the rules. This is the "collapse" part.</li> </ul> <p>Now let's break it down in detail so you can use this in your next game and look like a genius.</p> <!-- more --> <h2 id=key-concepts-of-wfc>Key Concepts of WFC 🤓<a class=headerlink href=#key-concepts-of-wfc title="Permanent link">&para;</a></h2> <h3 id=superposition-no-youre-not-in-physics-class>Superposition (No, You’re Not in Physics Class)<a class=headerlink href=#superposition-no-youre-not-in-physics-class title="Permanent link">&para;</a></h3> <p>At the start, each slot can be <em>anything</em>—just like your favorite RPG character before you completely ruin the build with bad choices. 😅 In WFC, this means every tile can be in a "superposition" of many possible states. Over time, WFC reduces this mess of possibilities by applying rules, eventually collapsing each slot to a single state.</p> <h3 id=adjacency-constraints-the-you-shall-not-pass-rules>Adjacency Constraints: The “You Shall Not Pass” Rules 🚧<a class=headerlink href=#adjacency-constraints-the-you-shall-not-pass-rules title="Permanent link">&para;</a></h3> <p>WFC’s bread and butter is adjacency constraints. You’ve got rules about which tiles can sit next to which. Picture a road tile that can only connect to other roads, or a water tile that refuses to be friends with desert tiles. It’s all about making sure the world makes sense.</p> <p>If you’re making a dungeon, for example, you can say, "Room A must connect to hallways, but Room B only likes to hang out with Room C and no one else." It’s like high school cliques, but for tiles.</p> <h3 id=entropy-the-hot-mess-meter>Entropy: The "Hot Mess" Meter 🔥<a class=headerlink href=#entropy-the-hot-mess-meter title="Permanent link">&para;</a></h3> <p>Remember entropy from physics class? It’s basically a measure of chaos. But in WFC, entropy just means the number of options a tile has left. A tile with high entropy is still a hot mess—it could be <em>anything</em>. A tile with low entropy, though, has its life together—it has only a few valid options. WFC works by collapsing the low-entropy tiles first, like prioritizing the people who already know what they want for lunch. 🍔</p> <h3 id=backtracking-undo-like-a-pro>Backtracking: Undo Like a Pro ⏪<a class=headerlink href=#backtracking-undo-like-a-pro title="Permanent link">&para;</a></h3> <p>Sometimes, despite all the rules, WFC gets stuck. Maybe no valid tiles can go in a spot. This is when WFC says, “Oops, my bad,” and <em>backtracks</em> to try again. It's the algorithm’s way of saying, "No worries, let's undo that and fix it."</p> <h2 id=where-can-you-use-wfc-in-games>Where Can You Use WFC in Games? 🎮<a class=headerlink href=#where-can-you-use-wfc-in-games title="Permanent link">&para;</a></h2> <h3 id=1-procedural-level-generation>1. Procedural Level Generation 🌍<a class=headerlink href=#1-procedural-level-generation title="Permanent link">&para;</a></h3> <p>One of the coolest things about WFC is its ability to generate levels that are not only random but also make sense. No more roads to nowhere!</p> <ul> <li><strong>Dungeon Generation</strong>: Imagine generating dungeons where rooms, hallways, and dead-ends all adhere to your design rules. WFC handles this beautifully.</li> <li><strong>Overworld Maps</strong>: You can create sprawling open-world maps with biomes that transition logically—deserts next to dunes, mountains surrounded by hills. Say goodbye to floating islands next to volcanoes! 🌋</li> </ul> <h3 id=2-texture-synthesis>2. Texture Synthesis 🎨<a class=headerlink href=#2-texture-synthesis title="Permanent link">&para;</a></h3> <p>WFC’s original job was to generate textures from small samples. In game development, this means you can take a tiny bit of grass or brick pattern and blow it up into a massive, seamless texture. You can forget those awkward texture seams that make your world look like a patchwork quilt gone wrong.</p> <h3 id=3-tiling-based-puzzle-games>3. Tiling-Based Puzzle Games 🧩<a class=headerlink href=#3-tiling-based-puzzle-games title="Permanent link">&para;</a></h3> <p>WFC is also perfect for games where tile-matching mechanics reign supreme. You could generate puzzles or adjust game boards dynamically, keeping things fresh and players on their toes.</p> <h3 id=4-story-or-quest-generation>4. Story or Quest Generation 📜<a class=headerlink href=#4-story-or-quest-generation title="Permanent link">&para;</a></h3> <p>WFC can go beyond just placing tiles—it can even help with generating quests or non-linear stories. Define a set of events and rules about how they fit together, and let WFC create unique quest chains that stay coherent. Move over, Dungeons &amp; Dragons! 🐉</p> <h2 id=how-to-implement-wfc-in-games>How to Implement WFC in Games 🚀<a class=headerlink href=#how-to-implement-wfc-in-games title="Permanent link">&para;</a></h2> <h3 id=step-1-define-your-tile-set>Step 1: Define Your Tile Set<a class=headerlink href=#step-1-define-your-tile-set title="Permanent link">&para;</a></h3> <p>First, decide what your tiles represent—whether they’re rooms, terrain, or objects. Next, define the constraints for each tile. Room A connects to Hallways, Room B connects to Room C, and so on.</p> <h3 id=step-2-set-up-the-grid-and-superposition>Step 2: Set Up the Grid and Superposition<a class=headerlink href=#step-2-set-up-the-grid-and-superposition title="Permanent link">&para;</a></h3> <p>Set up a grid where each cell can be <em>any</em> tile at first (superposition). WFC will gradually narrow down the possibilities based on neighboring tiles.</p> <h3 id=step-3-collapse-based-on-entropy>Step 3: Collapse Based on Entropy<a class=headerlink href=#step-3-collapse-based-on-entropy title="Permanent link">&para;</a></h3> <p>Now, the algorithm will look at each tile and decide which ones can go where. It collapses the tiles with the least options first (low entropy). Sort of like playing Tetris but with rules. 🎮</p> <h3 id=step-4-propagate-constraints>Step 4: Propagate Constraints<a class=headerlink href=#step-4-propagate-constraints title="Permanent link">&para;</a></h3> <p>As tiles are placed, WFC propagates the constraints to neighboring tiles, limiting their options. It keeps going until the whole grid is filled.</p> <h3 id=step-5-handle-backtracking>Step 5: Handle Backtracking<a class=headerlink href=#step-5-handle-backtracking title="Permanent link">&para;</a></h3> <p>If WFC hits a dead end (it happens!), the algorithm backtracks, rewinds a bit, and tries again. Like Ctrl+Z but for algorithms.</p> <h3 id=step-6-optimize-and-iterate>Step 6: Optimize and Iterate<a class=headerlink href=#step-6-optimize-and-iterate title="Permanent link">&para;</a></h3> <p>Once you've got the basics down, you can start optimizing. You might add symmetry rules to make the generated worlds more aesthetically pleasing or speed up the algorithm with parallel processing. ⚙️</p> <h2 id=the-pros-and-cons-of-wfc>The Pros and Cons of WFC 🎢<a class=headerlink href=#the-pros-and-cons-of-wfc title="Permanent link">&para;</a></h2> <h3 id=advantages>Advantages<a class=headerlink href=#advantages title="Permanent link">&para;</a></h3> <ul> <li><strong>Consistency</strong>: WFC creates coherent worlds, avoiding jarring transitions like forests sitting right next to cities. 🌳🏙️</li> <li><strong>Versatility</strong>: WFC can handle 2D and 3D worlds, quests, or even story generation.</li> <li><strong>Efficient Input</strong>: You only need a small input set and a few rules to generate huge worlds.</li> </ul> <h3 id=challenges>Challenges<a class=headerlink href=#challenges title="Permanent link">&para;</a></h3> <ul> <li><strong>Complexity</strong>: Setting up those rules is no joke. Too many constraints, and your world becomes boring. Too few, and it’s chaos.</li> <li><strong>Performance</strong>: WFC can be slow with large grids or lots of rules. Optimize or be prepared for some serious lag. 🐢</li> <li><strong>Overfitting</strong>: Too many strict rules can lead to predictable or repetitive results. Mix it up for some randomness!</li> </ul> <h2 id=implementation-for-wfc>Implementation for WFC 🛠️<a class=headerlink href=#implementation-for-wfc title="Permanent link">&para;</a></h2> <div class="language-c++ highlight"><pre><span></span><code><span id=__span-0-1><a id=__codelineno-0-1 name=__codelineno-0-1 href=#__codelineno-0-1></a><span class=c1>// Wave Function in C++</span>
</span><span id=__span-0-2><a id=__codelineno-0-2 name=__codelineno-0-2 href=#__codelineno-0-2></a><span class=cp>#include</span><span class=cpf>&lt;queue&gt;</span>
</span><span id=__span-0-3><a id=__codelineno-0-3 name=__codelineno-0-3 href=#__codelineno-0-3></a><span class=cp>#include</span><span class=w> </span><span class=cpf>&lt;vector&gt;</span>
</span><span id=__span-0-4><a id=__codelineno-0-4 name=__codelineno-0-4 href=#__codelineno-0-4></a><span class=cp>#include</span><span class=w> </span><span class=cpf>&lt;unordered_map&gt;</span>
</span><span id=__span-0-5><a id=__codelineno-0-5 name=__codelineno-0-5 href=#__codelineno-0-5></a><span class=cp>#include</span><span class=w> </span><span class=cpf>&lt;set&gt;</span>
</span><span id=__span-0-6><a id=__codelineno-0-6 name=__codelineno-0-6 href=#__codelineno-0-6></a><span class=cp>#include</span><span class=w> </span><span class=cpf>&lt;stack&gt;</span>
</span><span id=__span-0-7><a id=__codelineno-0-7 name=__codelineno-0-7 href=#__codelineno-0-7></a><span class=cp>#include</span><span class=w> </span><span class=cpf>&lt;algorithm&gt;</span>
</span><span id=__span-0-8><a id=__codelineno-0-8 name=__codelineno-0-8 href=#__codelineno-0-8></a><span class=cp>#include</span><span class=w> </span><span class=cpf>&lt;random&gt;</span>
</span><span id=__span-0-9><a id=__codelineno-0-9 name=__codelineno-0-9 href=#__codelineno-0-9></a>
</span><span id=__span-0-10><a id=__codelineno-0-10 name=__codelineno-0-10 href=#__codelineno-0-10></a><span class=c1>// Step 1: Define the tile set and adjacency constraints</span>
</span><span id=__span-0-11><a id=__codelineno-0-11 name=__codelineno-0-11 href=#__codelineno-0-11></a><span class=c1>// Change this based on your game&#39;s needs, you will need to link tiles to their their images or data</span>
</span><span id=__span-0-12><a id=__codelineno-0-12 name=__codelineno-0-12 href=#__codelineno-0-12></a><span class=k>enum</span><span class=w> </span><span class=nc>Tile</span><span class=w> </span><span class=p>{</span><span class=w> </span><span class=n>UNDEFINED</span><span class=p>,</span><span class=w> </span><span class=n>TileA</span><span class=p>,</span><span class=w> </span><span class=n>TileB</span><span class=p>,</span><span class=w> </span><span class=n>TileC</span><span class=p>,</span><span class=w> </span><span class=cm>/* ... other tiles */</span><span class=w> </span><span class=p>};</span>
</span><span id=__span-0-13><a id=__codelineno-0-13 name=__codelineno-0-13 href=#__codelineno-0-13></a>
</span><span id=__span-0-14><a id=__codelineno-0-14 name=__codelineno-0-14 href=#__codelineno-0-14></a><span class=c1>// set the rules for which tiles can be adjacent to each other</span>
</span><span id=__span-0-15><a id=__codelineno-0-15 name=__codelineno-0-15 href=#__codelineno-0-15></a><span class=c1>// unordered_map is O(1)  for lookups from the source tile</span>
</span><span id=__span-0-16><a id=__codelineno-0-16 name=__codelineno-0-16 href=#__codelineno-0-16></a><span class=c1>// unordered_set is O(1) for lookups from the target tile</span>
</span><span id=__span-0-17><a id=__codelineno-0-17 name=__codelineno-0-17 href=#__codelineno-0-17></a><span class=n>std</span><span class=o>::</span><span class=n>unordered_map</span><span class=o>&lt;</span><span class=n>Tile</span><span class=p>,</span><span class=w> </span><span class=n>std</span><span class=o>::</span><span class=n>unordered_set</span><span class=o>&lt;</span><span class=n>Tile</span><span class=o>&gt;&gt;</span><span class=w> </span><span class=n>constraints</span><span class=w> </span><span class=o>=</span><span class=w> </span><span class=p>{</span>
</span><span id=__span-0-18><a id=__codelineno-0-18 name=__codelineno-0-18 href=#__codelineno-0-18></a><span class=w>    </span><span class=p>{</span><span class=w> </span><span class=n>TileA</span><span class=p>,</span><span class=w> </span><span class=p>{</span><span class=w> </span><span class=n>TileB</span><span class=p>,</span><span class=w> </span><span class=n>TileC</span><span class=w> </span><span class=p>}</span><span class=w> </span><span class=p>},</span><span class=w> </span><span class=c1>// TileA can be adjacent to TileB and TileC</span>
</span><span id=__span-0-19><a id=__codelineno-0-19 name=__codelineno-0-19 href=#__codelineno-0-19></a><span class=w>    </span><span class=p>{</span><span class=w> </span><span class=n>TileB</span><span class=p>,</span><span class=w> </span><span class=p>{</span><span class=w> </span><span class=n>TileA</span><span class=p>,</span><span class=w> </span><span class=n>TileC</span><span class=w> </span><span class=p>}</span><span class=w> </span><span class=p>},</span>
</span><span id=__span-0-20><a id=__codelineno-0-20 name=__codelineno-0-20 href=#__codelineno-0-20></a><span class=w>    </span><span class=p>{</span><span class=w> </span><span class=n>TileC</span><span class=p>,</span><span class=w> </span><span class=p>{</span><span class=w> </span><span class=n>TileA</span><span class=w> </span><span class=p>}</span><span class=w> </span><span class=p>}</span>
</span><span id=__span-0-21><a id=__codelineno-0-21 name=__codelineno-0-21 href=#__codelineno-0-21></a><span class=w>    </span><span class=c1>// ... other tile constraints</span>
</span><span id=__span-0-22><a id=__codelineno-0-22 name=__codelineno-0-22 href=#__codelineno-0-22></a><span class=p>};</span>
</span><span id=__span-0-23><a id=__codelineno-0-23 name=__codelineno-0-23 href=#__codelineno-0-23></a>
</span><span id=__span-0-24><a id=__codelineno-0-24 name=__codelineno-0-24 href=#__codelineno-0-24></a><span class=c1>// Define a cell structure to hold possible tiles and the final collapsed tile</span>
</span><span id=__span-0-25><a id=__codelineno-0-25 name=__codelineno-0-25 href=#__codelineno-0-25></a><span class=k>struct</span><span class=w> </span><span class=nc>Cell</span><span class=w> </span><span class=p>{</span>
</span><span id=__span-0-26><a id=__codelineno-0-26 name=__codelineno-0-26 href=#__codelineno-0-26></a><span class=w>    </span><span class=n>std</span><span class=o>::</span><span class=n>set</span><span class=o>&lt;</span><span class=n>Tile</span><span class=o>&gt;</span><span class=w> </span><span class=n>possibleTiles</span><span class=p>;</span><span class=w> </span><span class=c1>// Possible states (tiles) for this cell</span>
</span><span id=__span-0-27><a id=__codelineno-0-27 name=__codelineno-0-27 href=#__codelineno-0-27></a><span class=w>    </span><span class=n>Tile</span><span class=w> </span><span class=n>collapsedTile</span><span class=w> </span><span class=o>=</span><span class=w> </span><span class=n>UNDEFINED</span><span class=p>;</span><span class=w> </span><span class=c1>// Collapsed state when determined</span>
</span><span id=__span-0-28><a id=__codelineno-0-28 name=__codelineno-0-28 href=#__codelineno-0-28></a><span class=p>};</span>
</span><span id=__span-0-29><a id=__codelineno-0-29 name=__codelineno-0-29 href=#__codelineno-0-29></a>
</span><span id=__span-0-30><a id=__codelineno-0-30 name=__codelineno-0-30 href=#__codelineno-0-30></a><span class=c1>// Step 2: Initialize the grid with superposition (all tiles are possible for each cell)</span>
</span><span id=__span-0-31><a id=__codelineno-0-31 name=__codelineno-0-31 href=#__codelineno-0-31></a><span class=c1>// vector of vectors to represent a 2D grid. modify this for 3D, anisotropic, graph or other grid types</span>
</span><span id=__span-0-32><a id=__codelineno-0-32 name=__codelineno-0-32 href=#__codelineno-0-32></a><span class=n>std</span><span class=o>::</span><span class=n>vector</span><span class=o>&lt;</span><span class=n>std</span><span class=o>::</span><span class=n>vector</span><span class=o>&lt;</span><span class=n>Cell</span><span class=o>&gt;&gt;</span><span class=w> </span><span class=n>initializeGrid</span><span class=p>(</span><span class=kt>int</span><span class=w> </span><span class=n>width</span><span class=p>,</span><span class=w> </span><span class=kt>int</span><span class=w> </span><span class=n>height</span><span class=p>,</span><span class=w> </span><span class=k>const</span><span class=w> </span><span class=n>std</span><span class=o>::</span><span class=n>set</span><span class=o>&lt;</span><span class=n>Tile</span><span class=o>&gt;&amp;</span><span class=w> </span><span class=n>tileSet</span><span class=p>)</span><span class=w> </span><span class=p>{</span>
</span><span id=__span-0-33><a id=__codelineno-0-33 name=__codelineno-0-33 href=#__codelineno-0-33></a><span class=w>    </span><span class=n>std</span><span class=o>::</span><span class=n>vector</span><span class=o>&lt;</span><span class=n>std</span><span class=o>::</span><span class=n>vector</span><span class=o>&lt;</span><span class=n>Cell</span><span class=o>&gt;&gt;</span><span class=w> </span><span class=n>grid</span><span class=p>(</span><span class=n>width</span><span class=p>,</span><span class=w> </span><span class=n>std</span><span class=o>::</span><span class=n>vector</span><span class=o>&lt;</span><span class=n>Cell</span><span class=o>&gt;</span><span class=p>(</span><span class=n>height</span><span class=p>));</span>
</span><span id=__span-0-34><a id=__codelineno-0-34 name=__codelineno-0-34 href=#__codelineno-0-34></a><span class=w>    </span><span class=k>for</span><span class=w> </span><span class=p>(</span><span class=k>auto</span><span class=o>&amp;</span><span class=w> </span><span class=n>row</span><span class=w> </span><span class=o>:</span><span class=w> </span><span class=n>grid</span><span class=p>)</span><span class=w> </span><span class=p>{</span>
</span><span id=__span-0-35><a id=__codelineno-0-35 name=__codelineno-0-35 href=#__codelineno-0-35></a><span class=w>        </span><span class=k>for</span><span class=w> </span><span class=p>(</span><span class=k>auto</span><span class=o>&amp;</span><span class=w> </span><span class=n>cell</span><span class=w> </span><span class=o>:</span><span class=w> </span><span class=n>row</span><span class=p>)</span><span class=w> </span><span class=p>{</span>
</span><span id=__span-0-36><a id=__codelineno-0-36 name=__codelineno-0-36 href=#__codelineno-0-36></a><span class=w>            </span><span class=n>cell</span><span class=p>.</span><span class=n>possibleTiles</span><span class=w> </span><span class=o>=</span><span class=w> </span><span class=n>tileSet</span><span class=p>;</span><span class=w> </span><span class=c1>// Initially, every cell can be any tile</span>
</span><span id=__span-0-37><a id=__codelineno-0-37 name=__codelineno-0-37 href=#__codelineno-0-37></a><span class=w>        </span><span class=p>}</span>
</span><span id=__span-0-38><a id=__codelineno-0-38 name=__codelineno-0-38 href=#__codelineno-0-38></a><span class=w>    </span><span class=p>}</span>
</span><span id=__span-0-39><a id=__codelineno-0-39 name=__codelineno-0-39 href=#__codelineno-0-39></a><span class=w>    </span><span class=k>return</span><span class=w> </span><span class=n>grid</span><span class=p>;</span>
</span><span id=__span-0-40><a id=__codelineno-0-40 name=__codelineno-0-40 href=#__codelineno-0-40></a><span class=p>}</span>
</span><span id=__span-0-41><a id=__codelineno-0-41 name=__codelineno-0-41 href=#__codelineno-0-41></a>
</span><span id=__span-0-42><a id=__codelineno-0-42 name=__codelineno-0-42 href=#__codelineno-0-42></a><span class=c1>// Step 3: Calculate entropy based on the number of possible states per cell</span>
</span><span id=__span-0-43><a id=__codelineno-0-43 name=__codelineno-0-43 href=#__codelineno-0-43></a><span class=c1>// entropy is the number of possible states for a cell and it measures the uncertainty degree. The chaos temperature</span>
</span><span id=__span-0-44><a id=__codelineno-0-44 name=__codelineno-0-44 href=#__codelineno-0-44></a><span class=kt>int</span><span class=w> </span><span class=n>calculateEntropy</span><span class=p>(</span><span class=k>const</span><span class=w> </span><span class=n>Cell</span><span class=o>&amp;</span><span class=w> </span><span class=n>cell</span><span class=p>)</span><span class=w> </span><span class=p>{</span>
</span><span id=__span-0-45><a id=__codelineno-0-45 name=__codelineno-0-45 href=#__codelineno-0-45></a><span class=w>    </span><span class=k>return</span><span class=w> </span><span class=n>cell</span><span class=p>.</span><span class=n>possibleTiles</span><span class=p>.</span><span class=n>size</span><span class=p>();</span>
</span><span id=__span-0-46><a id=__codelineno-0-46 name=__codelineno-0-46 href=#__codelineno-0-46></a><span class=p>}</span>
</span><span id=__span-0-47><a id=__codelineno-0-47 name=__codelineno-0-47 href=#__codelineno-0-47></a>
</span><span id=__span-0-48><a id=__codelineno-0-48 name=__codelineno-0-48 href=#__codelineno-0-48></a><span class=c1>// Step 4: Main function for Wave Function Collapse</span>
</span><span id=__span-0-49><a id=__codelineno-0-49 name=__codelineno-0-49 href=#__codelineno-0-49></a><span class=kt>void</span><span class=w> </span><span class=n>waveFunctionCollapse</span><span class=p>(</span><span class=n>std</span><span class=o>::</span><span class=n>vector</span><span class=o>&lt;</span><span class=n>std</span><span class=o>::</span><span class=n>vector</span><span class=o>&lt;</span><span class=n>Cell</span><span class=o>&gt;&gt;&amp;</span><span class=w> </span><span class=n>grid</span><span class=p>)</span><span class=w> </span><span class=p>{</span>
</span><span id=__span-0-50><a id=__codelineno-0-50 name=__codelineno-0-50 href=#__codelineno-0-50></a><span class=w>    </span><span class=n>std</span><span class=o>::</span><span class=n>stack</span><span class=o>&lt;</span><span class=n>Cell</span><span class=o>*&gt;</span><span class=w> </span><span class=n>backtrackStack</span><span class=p>;</span>
</span><span id=__span-0-51><a id=__codelineno-0-51 name=__codelineno-0-51 href=#__codelineno-0-51></a><span class=w>    </span><span class=c1>// you can use another random number generator or fine tune one to meet your needs</span>
</span><span id=__span-0-52><a id=__codelineno-0-52 name=__codelineno-0-52 href=#__codelineno-0-52></a><span class=w>    </span><span class=n>std</span><span class=o>::</span><span class=n>default_random_engine</span><span class=w> </span><span class=n>generator</span><span class=p>;</span>
</span><span id=__span-0-53><a id=__codelineno-0-53 name=__codelineno-0-53 href=#__codelineno-0-53></a>
</span><span id=__span-0-54><a id=__codelineno-0-54 name=__codelineno-0-54 href=#__codelineno-0-54></a><span class=w>    </span><span class=k>while</span><span class=w> </span><span class=p>(</span><span class=nb>true</span><span class=p>)</span><span class=w> </span><span class=p>{</span>
</span><span id=__span-0-55><a id=__codelineno-0-55 name=__codelineno-0-55 href=#__codelineno-0-55></a><span class=w>        </span><span class=c1>// 4a: Find the cell with the lowest entropy</span>
</span><span id=__span-0-56><a id=__codelineno-0-56 name=__codelineno-0-56 href=#__codelineno-0-56></a><span class=w>        </span><span class=c1>// greedy approach. It does not guarantee the solution will always be found or consistent. To have that, you will have to implement a better constraint propagation. But you can backpropagate and try again if it becaomes stuck or inconsistent. </span>
</span><span id=__span-0-57><a id=__codelineno-0-57 name=__codelineno-0-57 href=#__codelineno-0-57></a><span class=w>        </span><span class=n>Cell</span><span class=o>*</span><span class=w> </span><span class=n>cell</span><span class=w> </span><span class=o>=</span><span class=w> </span><span class=n>findLowestEntropyCell</span><span class=p>(</span><span class=n>grid</span><span class=p>);</span>
</span><span id=__span-0-58><a id=__codelineno-0-58 name=__codelineno-0-58 href=#__codelineno-0-58></a><span class=w>        </span><span class=k>if</span><span class=w> </span><span class=p>(</span><span class=o>!</span><span class=n>cell</span><span class=p>)</span><span class=w> </span><span class=k>break</span><span class=p>;</span><span class=w> </span><span class=c1>// All cells are collapsed</span>
</span><span id=__span-0-59><a id=__codelineno-0-59 name=__codelineno-0-59 href=#__codelineno-0-59></a>
</span><span id=__span-0-60><a id=__codelineno-0-60 name=__codelineno-0-60 href=#__codelineno-0-60></a><span class=w>        </span><span class=c1>// 4b: Randomly select a tile from the possible options</span>
</span><span id=__span-0-61><a id=__codelineno-0-61 name=__codelineno-0-61 href=#__codelineno-0-61></a><span class=w>        </span><span class=n>Tile</span><span class=w> </span><span class=n>chosenTile</span><span class=w> </span><span class=o>=</span><span class=w> </span><span class=n>randomChoice</span><span class=p>(</span><span class=n>cell</span><span class=o>-&gt;</span><span class=n>possibleTiles</span><span class=p>,</span><span class=w> </span><span class=n>generator</span><span class=p>);</span>
</span><span id=__span-0-62><a id=__codelineno-0-62 name=__codelineno-0-62 href=#__codelineno-0-62></a>
</span><span id=__span-0-63><a id=__codelineno-0-63 name=__codelineno-0-63 href=#__codelineno-0-63></a><span class=w>        </span><span class=c1>// 4c: Collapse the cell</span>
</span><span id=__span-0-64><a id=__codelineno-0-64 name=__codelineno-0-64 href=#__codelineno-0-64></a><span class=w>        </span><span class=n>cell</span><span class=o>-&gt;</span><span class=n>collapsedTile</span><span class=w> </span><span class=o>=</span><span class=w> </span><span class=n>chosenTile</span><span class=p>;</span>
</span><span id=__span-0-65><a id=__codelineno-0-65 name=__codelineno-0-65 href=#__codelineno-0-65></a><span class=w>        </span><span class=n>cell</span><span class=o>-&gt;</span><span class=n>possibleTiles</span><span class=w> </span><span class=o>=</span><span class=w> </span><span class=p>{</span><span class=w> </span><span class=n>chosenTile</span><span class=w> </span><span class=p>};</span>
</span><span id=__span-0-66><a id=__codelineno-0-66 name=__codelineno-0-66 href=#__codelineno-0-66></a>
</span><span id=__span-0-67><a id=__codelineno-0-67 name=__codelineno-0-67 href=#__codelineno-0-67></a><span class=w>        </span><span class=c1>// Save current state for potential backtracking</span>
</span><span id=__span-0-68><a id=__codelineno-0-68 name=__codelineno-0-68 href=#__codelineno-0-68></a><span class=w>        </span><span class=n>backtrackStack</span><span class=p>.</span><span class=n>push</span><span class=p>(</span><span class=n>cell</span><span class=p>);</span>
</span><span id=__span-0-69><a id=__codelineno-0-69 name=__codelineno-0-69 href=#__codelineno-0-69></a>
</span><span id=__span-0-70><a id=__codelineno-0-70 name=__codelineno-0-70 href=#__codelineno-0-70></a><span class=w>        </span><span class=c1>// Step 5: Propagate constraints to update neighboring cells</span>
</span><span id=__span-0-71><a id=__codelineno-0-71 name=__codelineno-0-71 href=#__codelineno-0-71></a><span class=w>        </span><span class=n>propagateConstraints</span><span class=p>(</span><span class=n>cell</span><span class=p>,</span><span class=w> </span><span class=n>grid</span><span class=p>,</span><span class=w> </span><span class=n>backtrackStack</span><span class=p>);</span>
</span><span id=__span-0-72><a id=__codelineno-0-72 name=__codelineno-0-72 href=#__codelineno-0-72></a>
</span><span id=__span-0-73><a id=__codelineno-0-73 name=__codelineno-0-73 href=#__codelineno-0-73></a><span class=w>        </span><span class=c1>// If no valid options remain, backtrack</span>
</span><span id=__span-0-74><a id=__codelineno-0-74 name=__codelineno-0-74 href=#__codelineno-0-74></a><span class=w>        </span><span class=k>if</span><span class=w> </span><span class=p>(</span><span class=o>!</span><span class=n>backtrackStack</span><span class=p>.</span><span class=n>empty</span><span class=p>()</span><span class=w> </span><span class=o>&amp;&amp;</span><span class=w> </span><span class=n>backtrackStack</span><span class=p>.</span><span class=n>top</span><span class=p>()</span><span class=o>-&gt;</span><span class=n>possibleTiles</span><span class=p>.</span><span class=n>empty</span><span class=p>())</span><span class=w> </span><span class=p>{</span>
</span><span id=__span-0-75><a id=__codelineno-0-75 name=__codelineno-0-75 href=#__codelineno-0-75></a><span class=w>            </span><span class=n>backtrack</span><span class=p>(</span><span class=n>grid</span><span class=p>,</span><span class=w> </span><span class=n>backtrackStack</span><span class=p>);</span>
</span><span id=__span-0-76><a id=__codelineno-0-76 name=__codelineno-0-76 href=#__codelineno-0-76></a><span class=w>        </span><span class=p>}</span>
</span><span id=__span-0-77><a id=__codelineno-0-77 name=__codelineno-0-77 href=#__codelineno-0-77></a><span class=w>    </span><span class=p>}</span>
</span><span id=__span-0-78><a id=__codelineno-0-78 name=__codelineno-0-78 href=#__codelineno-0-78></a><span class=p>}</span>
</span><span id=__span-0-79><a id=__codelineno-0-79 name=__codelineno-0-79 href=#__codelineno-0-79></a>
</span><span id=__span-0-80><a id=__codelineno-0-80 name=__codelineno-0-80 href=#__codelineno-0-80></a><span class=c1>// Step 5: Propagation function to enforce adjacency constraints</span>
</span><span id=__span-0-81><a id=__codelineno-0-81 name=__codelineno-0-81 href=#__codelineno-0-81></a><span class=kt>void</span><span class=w> </span><span class=n>propagateConstraints</span><span class=p>(</span><span class=n>Cell</span><span class=o>*</span><span class=w> </span><span class=n>cell</span><span class=p>,</span><span class=w> </span><span class=n>std</span><span class=o>::</span><span class=n>vector</span><span class=o>&lt;</span><span class=n>std</span><span class=o>::</span><span class=n>vector</span><span class=o>&lt;</span><span class=n>Cell</span><span class=o>&gt;&gt;&amp;</span><span class=w> </span><span class=n>grid</span><span class=p>,</span><span class=w> </span><span class=n>std</span><span class=o>::</span><span class=n>stack</span><span class=o>&lt;</span><span class=n>Cell</span><span class=o>*&gt;&amp;</span><span class=w> </span><span class=n>backtrackStack</span><span class=p>)</span><span class=w> </span><span class=p>{</span>
</span><span id=__span-0-82><a id=__codelineno-0-82 name=__codelineno-0-82 href=#__codelineno-0-82></a><span class=w>    </span><span class=k>for</span><span class=w> </span><span class=p>(</span><span class=n>Cell</span><span class=o>*</span><span class=w> </span><span class=n>neighbor</span><span class=w> </span><span class=o>:</span><span class=w> </span><span class=n>getNeighbors</span><span class=p>(</span><span class=n>cell</span><span class=p>,</span><span class=w> </span><span class=n>grid</span><span class=p>))</span><span class=w> </span><span class=p>{</span>
</span><span id=__span-0-83><a id=__codelineno-0-83 name=__codelineno-0-83 href=#__codelineno-0-83></a><span class=w>        </span><span class=c1>// Remove tiles from neighbor&#39;s options that don&#39;t match adjacency rules</span>
</span><span id=__span-0-84><a id=__codelineno-0-84 name=__codelineno-0-84 href=#__codelineno-0-84></a><span class=w>        </span><span class=k>for</span><span class=w> </span><span class=p>(</span><span class=k>auto</span><span class=w> </span><span class=n>it</span><span class=w> </span><span class=o>=</span><span class=w> </span><span class=n>neighbor</span><span class=o>-&gt;</span><span class=n>possibleTiles</span><span class=p>.</span><span class=n>begin</span><span class=p>();</span><span class=w> </span><span class=n>it</span><span class=w> </span><span class=o>!=</span><span class=w> </span><span class=n>neighbor</span><span class=o>-&gt;</span><span class=n>possibleTiles</span><span class=p>.</span><span class=n>end</span><span class=p>();)</span><span class=w> </span><span class=p>{</span>
</span><span id=__span-0-85><a id=__codelineno-0-85 name=__codelineno-0-85 href=#__codelineno-0-85></a><span class=w>            </span><span class=k>if</span><span class=w> </span><span class=p>(</span><span class=n>constraints</span><span class=p>[</span><span class=n>cell</span><span class=o>-&gt;</span><span class=n>collapsedTile</span><span class=p>].</span><span class=n>find</span><span class=p>(</span><span class=o>*</span><span class=n>it</span><span class=p>)</span><span class=w> </span><span class=o>==</span><span class=w> </span><span class=n>constraints</span><span class=p>[</span><span class=n>cell</span><span class=o>-&gt;</span><span class=n>collapsedTile</span><span class=p>].</span><span class=n>end</span><span class=p>())</span><span class=w> </span><span class=p>{</span>
</span><span id=__span-0-86><a id=__codelineno-0-86 name=__codelineno-0-86 href=#__codelineno-0-86></a><span class=w>                </span><span class=n>it</span><span class=w> </span><span class=o>=</span><span class=w> </span><span class=n>neighbor</span><span class=o>-&gt;</span><span class=n>possibleTiles</span><span class=p>.</span><span class=n>erase</span><span class=p>(</span><span class=n>it</span><span class=p>);</span>
</span><span id=__span-0-87><a id=__codelineno-0-87 name=__codelineno-0-87 href=#__codelineno-0-87></a><span class=w>            </span><span class=p>}</span><span class=w> </span><span class=k>else</span><span class=w> </span><span class=p>{</span>
</span><span id=__span-0-88><a id=__codelineno-0-88 name=__codelineno-0-88 href=#__codelineno-0-88></a><span class=w>                </span><span class=o>++</span><span class=n>it</span><span class=p>;</span>
</span><span id=__span-0-89><a id=__codelineno-0-89 name=__codelineno-0-89 href=#__codelineno-0-89></a><span class=w>            </span><span class=p>}</span>
</span><span id=__span-0-90><a id=__codelineno-0-90 name=__codelineno-0-90 href=#__codelineno-0-90></a><span class=w>        </span><span class=p>}</span>
</span><span id=__span-0-91><a id=__codelineno-0-91 name=__codelineno-0-91 href=#__codelineno-0-91></a>
</span><span id=__span-0-92><a id=__codelineno-0-92 name=__codelineno-0-92 href=#__codelineno-0-92></a><span class=w>        </span><span class=c1>// If neighbor has no valid options, prepare to backtrack</span>
</span><span id=__span-0-93><a id=__codelineno-0-93 name=__codelineno-0-93 href=#__codelineno-0-93></a><span class=w>        </span><span class=k>if</span><span class=w> </span><span class=p>(</span><span class=n>neighbor</span><span class=o>-&gt;</span><span class=n>possibleTiles</span><span class=p>.</span><span class=n>empty</span><span class=p>())</span><span class=w> </span><span class=p>{</span>
</span><span id=__span-0-94><a id=__codelineno-0-94 name=__codelineno-0-94 href=#__codelineno-0-94></a><span class=w>            </span><span class=n>backtrackStack</span><span class=p>.</span><span class=n>push</span><span class=p>(</span><span class=n>neighbor</span><span class=p>);</span>
</span><span id=__span-0-95><a id=__codelineno-0-95 name=__codelineno-0-95 href=#__codelineno-0-95></a><span class=w>        </span><span class=p>}</span>
</span><span id=__span-0-96><a id=__codelineno-0-96 name=__codelineno-0-96 href=#__codelineno-0-96></a><span class=w>    </span><span class=p>}</span>
</span><span id=__span-0-97><a id=__codelineno-0-97 name=__codelineno-0-97 href=#__codelineno-0-97></a><span class=p>}</span>
</span><span id=__span-0-98><a id=__codelineno-0-98 name=__codelineno-0-98 href=#__codelineno-0-98></a>
</span><span id=__span-0-99><a id=__codelineno-0-99 name=__codelineno-0-99 href=#__codelineno-0-99></a><span class=c1>// Step 6: Backtracking to fix conflicts</span>
</span><span id=__span-0-100><a id=__codelineno-0-100 name=__codelineno-0-100 href=#__codelineno-0-100></a><span class=kt>void</span><span class=w> </span><span class=n>backtrack</span><span class=p>(</span><span class=n>std</span><span class=o>::</span><span class=n>vector</span><span class=o>&lt;</span><span class=n>std</span><span class=o>::</span><span class=n>vector</span><span class=o>&lt;</span><span class=n>Cell</span><span class=o>&gt;&gt;&amp;</span><span class=w> </span><span class=n>grid</span><span class=p>,</span><span class=w> </span><span class=n>std</span><span class=o>::</span><span class=n>stack</span><span class=o>&lt;</span><span class=n>Cell</span><span class=o>*&gt;&amp;</span><span class=w> </span><span class=n>backtrackStack</span><span class=p>)</span><span class=w> </span><span class=p>{</span>
</span><span id=__span-0-101><a id=__codelineno-0-101 name=__codelineno-0-101 href=#__codelineno-0-101></a><span class=w>    </span><span class=c1>// Undo the last collapse step and reset the grid state</span>
</span><span id=__span-0-102><a id=__codelineno-0-102 name=__codelineno-0-102 href=#__codelineno-0-102></a><span class=w>    </span><span class=k>while</span><span class=w> </span><span class=p>(</span><span class=o>!</span><span class=n>backtrackStack</span><span class=p>.</span><span class=n>empty</span><span class=p>())</span><span class=w> </span><span class=p>{</span>
</span><span id=__span-0-103><a id=__codelineno-0-103 name=__codelineno-0-103 href=#__codelineno-0-103></a><span class=w>        </span><span class=n>Cell</span><span class=o>*</span><span class=w> </span><span class=n>cell</span><span class=w> </span><span class=o>=</span><span class=w> </span><span class=n>backtrackStack</span><span class=p>.</span><span class=n>top</span><span class=p>();</span>
</span><span id=__span-0-104><a id=__codelineno-0-104 name=__codelineno-0-104 href=#__codelineno-0-104></a><span class=w>        </span><span class=n>backtrackStack</span><span class=p>.</span><span class=n>pop</span><span class=p>();</span>
</span><span id=__span-0-105><a id=__codelineno-0-105 name=__codelineno-0-105 href=#__codelineno-0-105></a>
</span><span id=__span-0-106><a id=__codelineno-0-106 name=__codelineno-0-106 href=#__codelineno-0-106></a><span class=w>        </span><span class=n>cell</span><span class=o>-&gt;</span><span class=n>possibleTiles</span><span class=p>.</span><span class=n>clear</span><span class=p>();</span>
</span><span id=__span-0-107><a id=__codelineno-0-107 name=__codelineno-0-107 href=#__codelineno-0-107></a><span class=w>        </span><span class=n>cell</span><span class=o>-&gt;</span><span class=n>collapsedTile</span><span class=w> </span><span class=o>=</span><span class=w> </span><span class=n>Tile</span><span class=p>();</span><span class=w> </span><span class=c1>// Reset the collapsed state</span>
</span><span id=__span-0-108><a id=__codelineno-0-108 name=__codelineno-0-108 href=#__codelineno-0-108></a><span class=w>    </span><span class=p>}</span>
</span><span id=__span-0-109><a id=__codelineno-0-109 name=__codelineno-0-109 href=#__codelineno-0-109></a><span class=p>}</span>
</span><span id=__span-0-110><a id=__codelineno-0-110 name=__codelineno-0-110 href=#__codelineno-0-110></a>
</span><span id=__span-0-111><a id=__codelineno-0-111 name=__codelineno-0-111 href=#__codelineno-0-111></a><span class=c1>// Helper function to find the cell with the lowest entropy</span>
</span><span id=__span-0-112><a id=__codelineno-0-112 name=__codelineno-0-112 href=#__codelineno-0-112></a><span class=n>Cell</span><span class=o>*</span><span class=w> </span><span class=n>findLowestEntropyCell</span><span class=p>(</span><span class=n>std</span><span class=o>::</span><span class=n>vector</span><span class=o>&lt;</span><span class=n>std</span><span class=o>::</span><span class=n>vector</span><span class=o>&lt;</span><span class=n>Cell</span><span class=o>&gt;&gt;&amp;</span><span class=w> </span><span class=n>grid</span><span class=p>)</span><span class=w> </span><span class=p>{</span>
</span><span id=__span-0-113><a id=__codelineno-0-113 name=__codelineno-0-113 href=#__codelineno-0-113></a><span class=w>    </span><span class=c1>// you could rely on prioryty_queue or other data structures to optimize this</span>
</span><span id=__span-0-114><a id=__codelineno-0-114 name=__codelineno-0-114 href=#__codelineno-0-114></a><span class=w>    </span><span class=c1>// this is not optimized and will iterate over all cells</span>
</span><span id=__span-0-115><a id=__codelineno-0-115 name=__codelineno-0-115 href=#__codelineno-0-115></a><span class=w>    </span><span class=n>Cell</span><span class=o>*</span><span class=w> </span><span class=n>minEntropyCell</span><span class=w> </span><span class=o>=</span><span class=w> </span><span class=k>nullptr</span><span class=p>;</span>
</span><span id=__span-0-116><a id=__codelineno-0-116 name=__codelineno-0-116 href=#__codelineno-0-116></a><span class=w>    </span><span class=kt>int</span><span class=w> </span><span class=n>minEntropy</span><span class=w> </span><span class=o>=</span><span class=w> </span><span class=n>INT_MAX</span><span class=p>;</span>
</span><span id=__span-0-117><a id=__codelineno-0-117 name=__codelineno-0-117 href=#__codelineno-0-117></a><span class=w>    </span><span class=k>for</span><span class=w> </span><span class=p>(</span><span class=k>auto</span><span class=o>&amp;</span><span class=w> </span><span class=n>row</span><span class=w> </span><span class=o>:</span><span class=w> </span><span class=n>grid</span><span class=p>)</span><span class=w> </span><span class=p>{</span>
</span><span id=__span-0-118><a id=__codelineno-0-118 name=__codelineno-0-118 href=#__codelineno-0-118></a><span class=w>        </span><span class=k>for</span><span class=w> </span><span class=p>(</span><span class=k>auto</span><span class=o>&amp;</span><span class=w> </span><span class=n>cell</span><span class=w> </span><span class=o>:</span><span class=w> </span><span class=n>row</span><span class=p>)</span><span class=w> </span><span class=p>{</span>
</span><span id=__span-0-119><a id=__codelineno-0-119 name=__codelineno-0-119 href=#__codelineno-0-119></a><span class=w>            </span><span class=kt>int</span><span class=w> </span><span class=n>entropy</span><span class=w> </span><span class=o>=</span><span class=w> </span><span class=n>calculateEntropy</span><span class=p>(</span><span class=n>cell</span><span class=p>);</span>
</span><span id=__span-0-120><a id=__codelineno-0-120 name=__codelineno-0-120 href=#__codelineno-0-120></a><span class=w>            </span><span class=k>if</span><span class=w> </span><span class=p>(</span><span class=n>entropy</span><span class=w> </span><span class=o>&gt;</span><span class=w> </span><span class=mi>1</span><span class=w> </span><span class=o>&amp;&amp;</span><span class=w> </span><span class=n>entropy</span><span class=w> </span><span class=o>&lt;</span><span class=w> </span><span class=n>minEntropy</span><span class=p>)</span><span class=w> </span><span class=p>{</span>
</span><span id=__span-0-121><a id=__codelineno-0-121 name=__codelineno-0-121 href=#__codelineno-0-121></a><span class=w>                </span><span class=n>minEntropyCell</span><span class=w> </span><span class=o>=</span><span class=w> </span><span class=o>&amp;</span><span class=n>cell</span><span class=p>;</span>
</span><span id=__span-0-122><a id=__codelineno-0-122 name=__codelineno-0-122 href=#__codelineno-0-122></a><span class=w>                </span><span class=n>minEntropy</span><span class=w> </span><span class=o>=</span><span class=w> </span><span class=n>entropy</span><span class=p>;</span>
</span><span id=__span-0-123><a id=__codelineno-0-123 name=__codelineno-0-123 href=#__codelineno-0-123></a><span class=w>            </span><span class=p>}</span>
</span><span id=__span-0-124><a id=__codelineno-0-124 name=__codelineno-0-124 href=#__codelineno-0-124></a><span class=w>        </span><span class=p>}</span>
</span><span id=__span-0-125><a id=__codelineno-0-125 name=__codelineno-0-125 href=#__codelineno-0-125></a><span class=w>    </span><span class=p>}</span>
</span><span id=__span-0-126><a id=__codelineno-0-126 name=__codelineno-0-126 href=#__codelineno-0-126></a><span class=w>    </span><span class=k>return</span><span class=w> </span><span class=n>minEntropyCell</span><span class=p>;</span>
</span><span id=__span-0-127><a id=__codelineno-0-127 name=__codelineno-0-127 href=#__codelineno-0-127></a><span class=p>}</span>
</span><span id=__span-0-128><a id=__codelineno-0-128 name=__codelineno-0-128 href=#__codelineno-0-128></a>
</span><span id=__span-0-129><a id=__codelineno-0-129 name=__codelineno-0-129 href=#__codelineno-0-129></a><span class=c1>// Helper function to randomly select a tile from possible options</span>
</span><span id=__span-0-130><a id=__codelineno-0-130 name=__codelineno-0-130 href=#__codelineno-0-130></a><span class=n>Tile</span><span class=w> </span><span class=n>randomChoice</span><span class=p>(</span><span class=k>const</span><span class=w> </span><span class=n>std</span><span class=o>::</span><span class=n>set</span><span class=o>&lt;</span><span class=n>Tile</span><span class=o>&gt;&amp;</span><span class=w> </span><span class=n>tileOptions</span><span class=p>,</span><span class=w> </span><span class=n>std</span><span class=o>::</span><span class=n>default_random_engine</span><span class=o>&amp;</span><span class=w> </span><span class=n>generator</span><span class=p>)</span><span class=w> </span><span class=p>{</span>
</span><span id=__span-0-131><a id=__codelineno-0-131 name=__codelineno-0-131 href=#__codelineno-0-131></a><span class=w>    </span><span class=n>std</span><span class=o>::</span><span class=n>uniform_int_distribution</span><span class=o>&lt;</span><span class=kt>int</span><span class=o>&gt;</span><span class=w> </span><span class=n>distribution</span><span class=p>(</span><span class=mi>0</span><span class=p>,</span><span class=w> </span><span class=n>tileOptions</span><span class=p>.</span><span class=n>size</span><span class=p>()</span><span class=w> </span><span class=o>-</span><span class=w> </span><span class=mi>1</span><span class=p>);</span>
</span><span id=__span-0-132><a id=__codelineno-0-132 name=__codelineno-0-132 href=#__codelineno-0-132></a><span class=w>    </span><span class=k>auto</span><span class=w> </span><span class=n>it</span><span class=w> </span><span class=o>=</span><span class=w> </span><span class=n>std</span><span class=o>::</span><span class=n>next</span><span class=p>(</span><span class=n>tileOptions</span><span class=p>.</span><span class=n>begin</span><span class=p>(),</span><span class=w> </span><span class=n>distribution</span><span class=p>(</span><span class=n>generator</span><span class=p>));</span>
</span><span id=__span-0-133><a id=__codelineno-0-133 name=__codelineno-0-133 href=#__codelineno-0-133></a><span class=w>    </span><span class=k>return</span><span class=w> </span><span class=o>*</span><span class=n>it</span><span class=p>;</span>
</span><span id=__span-0-134><a id=__codelineno-0-134 name=__codelineno-0-134 href=#__codelineno-0-134></a><span class=p>}</span>
</span><span id=__span-0-135><a id=__codelineno-0-135 name=__codelineno-0-135 href=#__codelineno-0-135></a>
</span><span id=__span-0-136><a id=__codelineno-0-136 name=__codelineno-0-136 href=#__codelineno-0-136></a><span class=c1>// Helper function to get neighbors of a cell (implementation depends on grid type and size)</span>
</span><span id=__span-0-137><a id=__codelineno-0-137 name=__codelineno-0-137 href=#__codelineno-0-137></a><span class=n>std</span><span class=o>::</span><span class=n>vector</span><span class=o>&lt;</span><span class=n>Cell</span><span class=o>*&gt;</span><span class=w> </span><span class=n>getNeighbors</span><span class=p>(</span><span class=n>Cell</span><span class=o>*</span><span class=w> </span><span class=n>cell</span><span class=p>,</span><span class=w> </span><span class=n>std</span><span class=o>::</span><span class=n>vector</span><span class=o>&lt;</span><span class=n>std</span><span class=o>::</span><span class=n>vector</span><span class=o>&lt;</span><span class=n>Cell</span><span class=o>&gt;&gt;&amp;</span><span class=w> </span><span class=n>grid</span><span class=p>)</span><span class=w> </span><span class=p>{</span>
</span><span id=__span-0-138><a id=__codelineno-0-138 name=__codelineno-0-138 href=#__codelineno-0-138></a><span class=w>    </span><span class=n>std</span><span class=o>::</span><span class=n>vector</span><span class=o>&lt;</span><span class=n>Cell</span><span class=o>*&gt;</span><span class=w> </span><span class=n>neighbors</span><span class=p>;</span>
</span><span id=__span-0-139><a id=__codelineno-0-139 name=__codelineno-0-139 href=#__codelineno-0-139></a><span class=w>    </span><span class=c1>// Add neighbor finding logic here (e.g., adjacent cells in a 2D grid)</span>
</span><span id=__span-0-140><a id=__codelineno-0-140 name=__codelineno-0-140 href=#__codelineno-0-140></a><span class=w>    </span><span class=k>return</span><span class=w> </span><span class=n>neighbors</span><span class=p>;</span>
</span><span id=__span-0-141><a id=__codelineno-0-141 name=__codelineno-0-141 href=#__codelineno-0-141></a><span class=p>}</span>
</span></code></pre></div> <h2 id=conclusion>Conclusion<a class=headerlink href=#conclusion title="Permanent link">&para;</a></h2> <p>Wave Function Collapse is the ultimate game dev hack. It helps generate complex, rule-following worlds without losing the randomness that makes games exciting. Sure, it has its challenges—like any powerful tool—but once you get the hang of it, WFC can make your worlds, quests, and even stories feel richer and more dynamic. Plus, it saves you a ton of time!</p> <p>So, next time you need a procedural level, a tile-based puzzle, or a randomly generated quest, let WFC do the heavy lifting while you sit back and bask in the procedural glory.</p> <aside class=md-source-file> <span class=md-source-file__fact> <span class=md-icon title="Last update"> <svg xmlns=http://www.w3.org/2000/svg viewbox="0 0 24 24"><path d="M21 13.1c-.1 0-.3.1-.4.2l-1 1 2.1 2.1 1-1c.2-.2.2-.6 0-.8l-1.3-1.3c-.1-.1-.2-.2-.4-.2m-1.9 1.8-6.1 6V23h2.1l6.1-6.1zM12.5 7v5.2l4 2.4-1 1L11 13V7zM11 21.9c-5.1-.5-9-4.8-9-9.9C2 6.5 6.5 2 12 2c5.3 0 9.6 4.1 10 9.3-.3-.1-.6-.2-1-.2s-.7.1-1 .2C19.6 7.2 16.2 4 12 4c-4.4 0-8 3.6-8 8 0 4.1 3.1 7.5 7.1 7.9l-.1.2z"/></svg> </span> <span class="git-revision-date-localized-plugin git-revision-date-localized-plugin-date">October 31, 2024</span> </span> <span class=md-source-file__fact> <span class=md-icon title=Created> <svg xmlns=http://www.w3.org/2000/svg viewbox="0 0 24 24"><path d="M14.47 15.08 11 13V7h1.5v5.25l3.08 1.83c-.41.28-.79.62-1.11 1m-1.39 4.84c-.36.05-.71.08-1.08.08-4.42 0-8-3.58-8-8s3.58-8 8-8 8 3.58 8 8c0 .37-.03.72-.08 1.08.69.1 1.33.32 1.92.64.1-.56.16-1.13.16-1.72 0-5.5-4.5-10-10-10S2 6.5 2 12s4.47 10 10 10c.59 0 1.16-.06 1.72-.16-.32-.59-.54-1.23-.64-1.92M18 15v3h-3v2h3v3h2v-3h3v-2h-3v-3z"/></svg> </span> <span class="git-revision-date-localized-plugin git-revision-date-localized-plugin-date">October 24, 2024</span> </span> </aside> </article> </div> <script>var target=document.getElementById(location.hash.slice(1));target&&target.name&&(target.checked=target.name.startsWith("__tabbed_"))</script> </div> <button type=button class="md-top md-icon" data-md-component=top hidden> <svg xmlns=http://www.w3.org/2000/svg viewbox="0 0 24 24"><path d="M13 20h-2V8l-5.5 5.5-1.42-1.42L12 4.16l7.92 7.92-1.42 1.42L13 8z"/></svg> Back to top </button> </main> <footer class=md-footer> <nav class="md-footer__inner md-grid" aria-label=Footer> <a href=../../06-pathfinding/ class="md-footer__link md-footer__link--prev" aria-label="Previous: Pathfinding"> <div class="md-footer__button md-icon"> <svg xmlns=http://www.w3.org/2000/svg viewbox="0 0 24 24"><path d="M20 11v2H8l5.5 5.5-1.42 1.42L4.16 12l7.92-7.92L13.5 5.5 8 11z"/></svg> </div> <div class=md-footer__title> <span class=md-footer__direction> Previous </span> <div class=md-ellipsis> Pathfinding </div> </div> </a> <a href=../HydraulicErosion/ class="md-footer__link md-footer__link--next" aria-label="Next: Hydraulic Erosion"> <div class=md-footer__title> <span class=md-footer__direction> Next </span> <div class=md-ellipsis> Hydraulic Erosion </div> </div> <div class="md-footer__button md-icon"> <svg xmlns=http://www.w3.org/2000/svg viewbox="0 0 24 24"><path d="M4 11v2h12l-5.5 5.5 1.42 1.42L19.84 12l-7.92-7.92L10.5 5.5 16 11z"/></svg> </div> </a> </nav> <div class="md-footer-meta md-typeset"> <div class="md-footer-meta__inner md-grid"> <div class=md-copyright> <div class=md-copyright__highlight> Copyright &copy; 2024 Tolstenko, Game Guild Community and Others </div> </div> </div> </div> </footer> </div> <div class=md-dialog data-md-component=dialog> <div class="md-dialog__inner md-typeset"></div> </div> <div class=md-consent data-md-component=consent id=__consent hidden> <div class=md-consent__overlay></div> <aside class=md-consent__inner> <form class="md-consent__form md-grid md-typeset" name=consent> <h4></h4> <p>This site uses cookies to provide you with a better user experience. By using this site you consent to our use of cookies.</p> <input class=md-toggle type=checkbox id=__settings> <div class=md-consent__settings> <ul class=task-list> <li class=task-list-item> <label class=task-list-control> <input type=checkbox name=smartlook checked> <span class=task-list-indicator></span> SmartLook </label> </li> <li class=task-list-item> <label class=task-list-control> <input type=checkbox name=analytics checked> <span class=task-list-indicator></span> Google Analytics </label> </li> <li class=task-list-item> <label class=task-list-control> <input type=checkbox name=github checked> <span class=task-list-indicator></span> GitHub </label> </li> </ul> </div> <div class=md-consent__controls> <button class="md-button md-button--primary">Accept</button> <label class=md-button for=__settings>Manage settings</label> </div> </form> </aside> </div> <script>var consent=__md_get("__consent");if(consent)for(var input of document.forms.consent.elements)input.name&&(input.checked=consent[input.name]||!1);else"file:"!==location.protocol&&setTimeout((function(){document.querySelector("[data-md-component=consent]").hidden=!1}),250);var form=document.forms.consent;for(var action of["submit","reset"])form.addEventListener(action,(function(e){if(e.preventDefault(),"reset"===e.type)for(var n of document.forms.consent.elements)n.name&&(n.checked=!1);__md_set("__consent",Object.fromEntries(Array.from(new FormData(form).keys()).map((function(e){return[e,!0]})))),location.hash="",location.reload()}))</script> <script id=__config type=application/json>{"annotate": {"json": [".s2"]}, "base": "../../..", "features": ["attr_list", "md_in_html", "pymdownx.superfences", "announce.dismiss", "content.action.edit", "content.code.annotate", "content.code.copy", "content.code.select", "content.tooltips", "navigation.footer", "navigation.indexes", "navigation.prune", "navigation.tabs", "navigation.top", "navigation.tracking", "navigation.path", "search.highlight", "search.share", "search.suggest", "toc.follow", "toc.integrate"], "search": "../../../assets/javascripts/workers/search.c7c1ca2c.min.js", "translations": {"clipboard.copied": "Copied to clipboard", "clipboard.copy": "Copy to clipboard", "search.result.more.one": "1 more on this page", "search.result.more.other": "# more on this page", "search.result.none": "No matching documents", "search.result.one": "1 matching document", "search.result.other": "# matching documents", "search.result.placeholder": "Type to start searching", "search.result.term.missing": "Missing", "select.version": "Select version"}}</script> <script src=../../../assets/javascripts/bundle.203fd0bc.min.js></script> <script src=../../../js/mkdocs-charts-plugin.js></script> <script src=../../../javascripts/mathjax.js></script> <script src="https://polyfill.io/v3/polyfill.min.js?features=es6"></script> <script src=https://cdn.jsdelivr.net/npm/mathjax@3/es5/tex-mml-chtml.js></script> <script src=https://cdn.jsdelivr.net/npm/vega@5></script> <script src=https://cdn.jsdelivr.net/npm/vega-lite@5></script> <script src=https://cdn.jsdelivr.net/npm/vega-embed@6></script> <script id="init-glightbox">const lightbox = GLightbox({"touchNavigation": true, "loop": false, "zoomable": true, "draggable": true, "openEffect": "zoom", "closeEffect": "zoom", "slideEffect": "slide"});
document$.subscribe(() => { lightbox.reload() });
</script></body> </html>