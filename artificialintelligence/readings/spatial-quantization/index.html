<!doctype html><html lang=en class=no-js> <head><meta charset=utf-8><meta name=viewport content="width=device-width,initial-scale=1"><meta name=description content="Awesome GameDev Resources for learning how to make games"><meta name=author content="See contributors and authors at https://github.com/InfiniBrains/Awesome-GameDev-Resources/graphs/contributors"><link href=https://courses.tolstenko.net/artificialintelligence/readings/spatial-quantization/ rel=canonical><link href=../../ rel=prev><link href=../../04-spatialhashing/ rel=next><link rel=alternate type=application/rss+xml title="RSS feed" href=../../../feed_rss_created.xml><link rel=alternate type=application/rss+xml title="RSS feed of updated content" href=../../../feed_rss_updated.xml><link rel=icon href=../../../assets/logo.png><meta name=generator content="mkdocs-1.6.1, mkdocs-material-9.5.44+insiders-4.53.14"><title>Spatial Quantization - Awesome GameDev Resources</title><link rel=stylesheet href=../../../assets/stylesheets/main.12320a83.min.css><link rel=stylesheet href=../../../assets/stylesheets/palette.ab4e12ef.min.css><link rel=preconnect href=https://fonts.gstatic.com crossorigin><link rel=stylesheet href="https://fonts.googleapis.com/css?family=Roboto:300,300i,400,400i,700,700i%7CRoboto+Mono:400,400i,700,700i&display=fallback"><style>:root{--md-text-font:"Roboto";--md-code-font:"Roboto Mono"}</style><script>__md_scope=new URL("../../..",location),__md_hash=e=>[...e].reduce(((e,_)=>(e<<5)-e+_.charCodeAt(0)),0),__md_get=(e,_=localStorage,t=__md_scope)=>JSON.parse(_.getItem(t.pathname+"."+e)),__md_set=(e,_,t=localStorage,a=__md_scope)=>{try{t.setItem(a.pathname+"."+e,JSON.stringify(_))}catch(e){}}</script><script id=__analytics>function __md_analytics(){function e(){dataLayer.push(arguments)}window.dataLayer=window.dataLayer||[],e("js",new Date),e("config","G-347541715"),document.addEventListener("DOMContentLoaded",(function(){document.forms.search&&document.forms.search.query.addEventListener("blur",(function(){this.value&&e("event","search",{search_term:this.value})}));document$.subscribe((function(){var t=document.forms.feedback;if(void 0!==t)for(var a of t.querySelectorAll("[type=submit]"))a.addEventListener("click",(function(a){a.preventDefault();var n=document.location.pathname,d=this.getAttribute("data-md-value");e("event","feedback",{page:n,data:d}),t.firstElementChild.disabled=!0;var r=t.querySelector(".md-feedback__note [data-md-value='"+d+"']");r&&(r.hidden=!1)})),t.hidden=!1})),location$.subscribe((function(t){e("config","G-347541715",{page_path:t.pathname})}))}));var t=document.createElement("script");t.async=!0,t.src="https://www.googletagmanager.com/gtag/js?id=G-347541715",document.getElementById("__analytics").insertAdjacentElement("afterEnd",t)}</script><script>if("undefined"!=typeof __md_analytics){var consent=__md_get("__consent");consent&&consent.analytics&&__md_analytics()}</script><meta property=og:type content=website><meta property=og:title content="Spatial Quantization - Awesome GameDev Resources"><meta property=og:description content="Awesome GameDev Resources for learning how to make games"><meta property=og:image content=https://courses.tolstenko.net/assets/images/social/artificialintelligence/readings/spatial-quantization.png><meta property=og:image:type content=image/png><meta property=og:image:width content=1200><meta property=og:image:height content=630><meta content=https://courses.tolstenko.net/artificialintelligence/readings/spatial-quantization/ property=og:url><meta property=twitter:card content=summary_large_image><meta property=twitter:title content="Spatial Quantization - Awesome GameDev Resources"><meta property=twitter:description content="Awesome GameDev Resources for learning how to make games"><meta property=twitter:image content=https://courses.tolstenko.net/assets/images/social/artificialintelligence/readings/spatial-quantization.png> <link href="../../../assets/stylesheets/glightbox.min.css" rel="stylesheet"/><style>
    html.glightbox-open { overflow: initial; height: 100%; }
    .gslide-title { margin-top: 0px; user-select: text; }
    .gslide-desc { color: #666; user-select: text; }
    .gslide-image img { background: white; }
    .gscrollbar-fixer { padding-right: 15px; }
    .gdesc-inner { font-size: 0.75rem; }
    body[data-md-color-scheme="slate"] .gdesc-inner { background: var(--md-default-bg-color);}
    body[data-md-color-scheme="slate"] .gslide-title { color: var(--md-default-fg-color);}
    body[data-md-color-scheme="slate"] .gslide-desc { color: var(--md-default-fg-color);}</style> <script src="../../../assets/javascripts/glightbox.min.js"></script></head> <body dir=ltr data-md-color-scheme=default data-md-color-primary=indigo data-md-color-accent=indigo> <input class=md-toggle data-md-toggle=drawer type=checkbox id=__drawer autocomplete=off> <input class=md-toggle data-md-toggle=search type=checkbox id=__search autocomplete=off> <label class=md-overlay for=__drawer></label> <div data-md-component=skip> <a href=#space-quantization class=md-skip> Skip to content </a> </div> <div data-md-component=announce> </div> <header class=md-header data-md-component=header> <nav class="md-header__inner md-grid" aria-label=Header> <a href=../../.. title="Awesome GameDev Resources" class="md-header__button md-logo" aria-label="Awesome GameDev Resources" data-md-component=logo> <img src=../../../assets/logo.png alt=logo> </a> <label class="md-header__button md-icon" for=__drawer> <svg xmlns=http://www.w3.org/2000/svg viewbox="0 0 24 24"><path d="M3 6h18v2H3zm0 5h18v2H3zm0 5h18v2H3z"/></svg> </label> <div class=md-header__title data-md-component=header-title> <div class=md-header__ellipsis> <div class=md-header__topic> <span class=md-ellipsis> Awesome GameDev Resources </span> </div> <div class=md-header__topic data-md-component=header-topic> <span class=md-ellipsis> Spatial Quantization </span> </div> </div> </div> <form class=md-header__option data-md-component=palette> <input class=md-option data-md-color-media=(prefers-color-scheme) data-md-color-scheme=default data-md-color-primary=indigo data-md-color-accent=indigo aria-label="Switch to light mode" type=radio name=__palette id=__palette_0> <label class="md-header__button md-icon" title="Switch to light mode" for=__palette_1 hidden> <svg xmlns=http://www.w3.org/2000/svg viewbox="0 0 24 24"><path d="m14.3 16-.7-2h-3.2l-.7 2H7.8L11 7h2l3.2 9zM20 8.69V4h-4.69L12 .69 8.69 4H4v4.69L.69 12 4 15.31V20h4.69L12 23.31 15.31 20H20v-4.69L23.31 12zm-9.15 3.96h2.3L12 9z"/></svg> </label> <input class=md-option data-md-color-media="(prefers-color-scheme: light)" data-md-color-scheme=default data-md-color-primary=indigo data-md-color-accent=indigo aria-label="Switch to dark mode" type=radio name=__palette id=__palette_1> <label class="md-header__button md-icon" title="Switch to dark mode" for=__palette_2 hidden> <svg xmlns=http://www.w3.org/2000/svg viewbox="0 0 24 24"><path d="M12 8a4 4 0 0 0-4 4 4 4 0 0 0 4 4 4 4 0 0 0 4-4 4 4 0 0 0-4-4m0 10a6 6 0 0 1-6-6 6 6 0 0 1 6-6 6 6 0 0 1 6 6 6 6 0 0 1-6 6m8-9.31V4h-4.69L12 .69 8.69 4H4v4.69L.69 12 4 15.31V20h4.69L12 23.31 15.31 20H20v-4.69L23.31 12z"/></svg> </label> <input class=md-option data-md-color-media="(prefers-color-scheme: dark)" data-md-color-scheme=slate data-md-color-primary=indigo data-md-color-accent=indigo aria-label="Switch to system preference" type=radio name=__palette id=__palette_2> <label class="md-header__button md-icon" title="Switch to system preference" for=__palette_0 hidden> <svg xmlns=http://www.w3.org/2000/svg viewbox="0 0 24 24"><path d="M12 18c-.89 0-1.74-.2-2.5-.55C11.56 16.5 13 14.42 13 12s-1.44-4.5-3.5-5.45C10.26 6.2 11.11 6 12 6a6 6 0 0 1 6 6 6 6 0 0 1-6 6m8-9.31V4h-4.69L12 .69 8.69 4H4v4.69L.69 12 4 15.31V20h4.69L12 23.31 15.31 20H20v-4.69L23.31 12z"/></svg> </label> </form> <script>var palette=__md_get("__palette");if(palette&&palette.color){if("(prefers-color-scheme)"===palette.color.media){var media=matchMedia("(prefers-color-scheme: light)"),input=document.querySelector(media.matches?"[data-md-color-media='(prefers-color-scheme: light)']":"[data-md-color-media='(prefers-color-scheme: dark)']");palette.color.media=input.getAttribute("data-md-color-media"),palette.color.scheme=input.getAttribute("data-md-color-scheme"),palette.color.primary=input.getAttribute("data-md-color-primary"),palette.color.accent=input.getAttribute("data-md-color-accent")}for(var[key,value]of Object.entries(palette.color))document.body.setAttribute("data-md-color-"+key,value)}</script> <label class="md-header__button md-icon" for=__search> <svg xmlns=http://www.w3.org/2000/svg viewbox="0 0 24 24"><path d="M9.5 3A6.5 6.5 0 0 1 16 9.5c0 1.61-.59 3.09-1.56 4.23l.27.27h.79l5 5-1.5 1.5-5-5v-.79l-.27-.27A6.52 6.52 0 0 1 9.5 16 6.5 6.5 0 0 1 3 9.5 6.5 6.5 0 0 1 9.5 3m0 2C7 5 5 7 5 9.5S7 14 9.5 14 14 12 14 9.5 12 5 9.5 5"/></svg> </label> <div class=md-search data-md-component=search role=dialog> <label class=md-search__overlay for=__search></label> <div class=md-search__inner role=search> <form class=md-search__form name=search> <input type=text class=md-search__input name=query aria-label=Search placeholder=Search autocapitalize=off autocorrect=off autocomplete=off spellcheck=false data-md-component=search-query required> <label class="md-search__icon md-icon" for=__search> <svg xmlns=http://www.w3.org/2000/svg viewbox="0 0 24 24"><path d="M9.5 3A6.5 6.5 0 0 1 16 9.5c0 1.61-.59 3.09-1.56 4.23l.27.27h.79l5 5-1.5 1.5-5-5v-.79l-.27-.27A6.52 6.52 0 0 1 9.5 16 6.5 6.5 0 0 1 3 9.5 6.5 6.5 0 0 1 9.5 3m0 2C7 5 5 7 5 9.5S7 14 9.5 14 14 12 14 9.5 12 5 9.5 5"/></svg> <svg xmlns=http://www.w3.org/2000/svg viewbox="0 0 24 24"><path d="M20 11v2H8l5.5 5.5-1.42 1.42L4.16 12l7.92-7.92L13.5 5.5 8 11z"/></svg> </label> <nav class=md-search__options aria-label=Search> <a href=javascript:void(0) class="md-search__icon md-icon" title=Share aria-label=Share data-clipboard data-clipboard-text data-md-component=search-share tabindex=-1> <svg xmlns=http://www.w3.org/2000/svg viewbox="0 0 24 24"><path d="M18 16.08c-.76 0-1.44.3-1.96.77L8.91 12.7c.05-.23.09-.46.09-.7s-.04-.47-.09-.7l7.05-4.11c.54.5 1.25.81 2.04.81a3 3 0 0 0 3-3 3 3 0 0 0-3-3 3 3 0 0 0-3 3c0 .24.04.47.09.7L8.04 9.81C7.5 9.31 6.79 9 6 9a3 3 0 0 0-3 3 3 3 0 0 0 3 3c.79 0 1.5-.31 2.04-.81l7.12 4.15c-.05.21-.08.43-.08.66 0 1.61 1.31 2.91 2.92 2.91s2.92-1.3 2.92-2.91A2.92 2.92 0 0 0 18 16.08"/></svg> </a> <button type=reset class="md-search__icon md-icon" title=Clear aria-label=Clear tabindex=-1> <svg xmlns=http://www.w3.org/2000/svg viewbox="0 0 24 24"><path d="M19 6.41 17.59 5 12 10.59 6.41 5 5 6.41 10.59 12 5 17.59 6.41 19 12 13.41 17.59 19 19 17.59 13.41 12z"/></svg> </button> </nav> <div class=md-search__suggest data-md-component=search-suggest></div> </form> <div class=md-search__output> <div class=md-search__scrollwrap tabindex=0 data-md-scrollfix> <div class=md-search-result data-md-component=search-result> <div class=md-search-result__meta> Initializing search </div> <ol class=md-search-result__list role=presentation></ol> </div> </div> </div> </div> </div> <div class=md-header__source> <a href=https://github.com/InfiniBrains/Awesome-GameDev-Resources title="Go to repository" class=md-source data-md-component=source> <div class="md-source__icon md-icon"> <svg xmlns=http://www.w3.org/2000/svg viewbox="0 0 448 512"><!-- Font Awesome Free 6.6.0 by @fontawesome - https://fontawesome.com License - https://fontawesome.com/license/free (Icons: CC BY 4.0, Fonts: SIL OFL 1.1, Code: MIT License) Copyright 2024 Fonticons, Inc.--><path d="M439.55 236.05 244 40.45a28.87 28.87 0 0 0-40.81 0l-40.66 40.63 51.52 51.52c27.06-9.14 52.68 16.77 43.39 43.68l49.66 49.66c34.23-11.8 61.18 31 35.47 56.69-26.49 26.49-70.21-2.87-56-37.34L240.22 199v121.85c25.3 12.54 22.26 41.85 9.08 55a34.34 34.34 0 0 1-48.55 0c-17.57-17.6-11.07-46.91 11.25-56v-123c-20.8-8.51-24.6-30.74-18.64-45L142.57 101 8.45 235.14a28.86 28.86 0 0 0 0 40.81l195.61 195.6a28.86 28.86 0 0 0 40.8 0l194.69-194.69a28.86 28.86 0 0 0 0-40.81"/></svg> </div> <div class=md-source__repository> InfiniBrains/Awesome-GameDev-Resources </div> </a> </div> </nav> </header> <div class=md-container data-md-component=container> <nav class=md-tabs aria-label=Tabs data-md-component=tabs> <div class=md-grid> <ul class=md-tabs__list> <li class=md-tabs__item> <a href=../../.. class=md-tabs__link> Home </a> </li> <li class=md-tabs__item> <a href=../../../introgameprog/ class=md-tabs__link> Intro. Game Programming </a> </li> <li class="md-tabs__item md-tabs__item--active"> <a href=../../ class=md-tabs__link> AI </a> </li> <li class=md-tabs__item> <a href=../../../intro/ class=md-tabs__link> Intro. Programming </a> </li> <li class=md-tabs__item> <a href=../../../advanced/ class=md-tabs__link> Adv. Programming </a> </li> <li class=md-tabs__item> <a href=../../../algorithms/ class=md-tabs__link> Algorithms </a> </li> <li class=md-tabs__item> <a href=../../../portfolio/ class=md-tabs__link> Portfolio </a> </li> <li class=md-tabs__item> <a href=../../../blog/ class=md-tabs__link> Blog </a> </li> <li class=md-tabs__item> <a href=../../../support/50rs-button/ class=md-tabs__link> Support </a> </li> </ul> </div> </nav> <main class=md-main data-md-component=main> <div class="md-main__inner md-grid"> <div class="md-sidebar md-sidebar--primary" data-md-component=sidebar data-md-type=navigation> <div class=md-sidebar__scrollwrap> <div class=md-sidebar__inner> <nav class="md-nav md-nav--primary md-nav--lifted md-nav--integrated" aria-label=Navigation data-md-level=0> <label class=md-nav__title for=__drawer> <a href=../../.. title="Awesome GameDev Resources" class="md-nav__button md-logo" aria-label="Awesome GameDev Resources" data-md-component=logo> <img src=../../../assets/logo.png alt=logo> </a> Awesome GameDev Resources </label> <div class=md-nav__source> <a href=https://github.com/InfiniBrains/Awesome-GameDev-Resources title="Go to repository" class=md-source data-md-component=source> <div class="md-source__icon md-icon"> <svg xmlns=http://www.w3.org/2000/svg viewbox="0 0 448 512"><!-- Font Awesome Free 6.6.0 by @fontawesome - https://fontawesome.com License - https://fontawesome.com/license/free (Icons: CC BY 4.0, Fonts: SIL OFL 1.1, Code: MIT License) Copyright 2024 Fonticons, Inc.--><path d="M439.55 236.05 244 40.45a28.87 28.87 0 0 0-40.81 0l-40.66 40.63 51.52 51.52c27.06-9.14 52.68 16.77 43.39 43.68l49.66 49.66c34.23-11.8 61.18 31 35.47 56.69-26.49 26.49-70.21-2.87-56-37.34L240.22 199v121.85c25.3 12.54 22.26 41.85 9.08 55a34.34 34.34 0 0 1-48.55 0c-17.57-17.6-11.07-46.91 11.25-56v-123c-20.8-8.51-24.6-30.74-18.64-45L142.57 101 8.45 235.14a28.86 28.86 0 0 0 0 40.81l195.61 195.6a28.86 28.86 0 0 0 40.8 0l194.69-194.69a28.86 28.86 0 0 0 0-40.81"/></svg> </div> <div class=md-source__repository> InfiniBrains/Awesome-GameDev-Resources </div> </a> </div> <ul class=md-nav__list data-md-scrollfix> <li class=md-nav__item> <a href=../../.. class=md-nav__link> <span class=md-ellipsis> Home </span> </a> </li> <li class="md-nav__item md-nav__item--pruned md-nav__item--nested"> <a href=../../../introgameprog/ class=md-nav__link> <span class=md-ellipsis> Intro. Game Programming </span> <span class="md-nav__icon md-icon"></span> </a> </li> <li class="md-nav__item md-nav__item--active md-nav__item--section md-nav__item--nested"> <input class="md-nav__toggle md-toggle " type=checkbox id=__nav_3 checked> <div class="md-nav__link md-nav__container"> <a href=../../ class="md-nav__link "> <span class=md-ellipsis> AI </span> </a> <label class="md-nav__link " for=__nav_3 id=__nav_3_label tabindex> <span class="md-nav__icon md-icon"></span> </label> </div> <nav class=md-nav data-md-level=1 aria-labelledby=__nav_3_label aria-expanded=true> <label class=md-nav__title for=__nav_3> <span class="md-nav__icon md-icon"></span> AI </label> <ul class=md-nav__list data-md-scrollfix> <li class="md-nav__item md-nav__item--active"> <input class="md-nav__toggle md-toggle" type=checkbox id=__toc> <a href=./ class="md-nav__link md-nav__link--active"> <span class=md-ellipsis> Spatial Quantization </span> </a> </li> <li class=md-nav__item> <a href=../../04-spatialhashing/ class=md-nav__link> <span class=md-ellipsis> Spatial Hashing </span> </a> </li> <li class=md-nav__item> <a href=../../05-kdtree/ class=md-nav__link> <span class=md-ellipsis> KD-Tree </span> </a> </li> <li class=md-nav__item> <a href=../../06-pathfinding/ class=md-nav__link> <span class=md-ellipsis> Pathfinding </span> </a> </li> <li class=md-nav__item> <a href=../../01-pcg/WaveFunctionCollapse/ class=md-nav__link> <span class=md-ellipsis> Wave Function Collapse </span> </a> </li> <li class=md-nav__item> <a href=../../01-pcg/HydraulicErosion/ class=md-nav__link> <span class=md-ellipsis> Hydraulic Erosion </span> </a> </li> <li class=md-nav__item> <a href=../../../blog/2023/10/02/memory-efficient-data-structure-for-procedural-maze-generation/ class=md-nav__link> <span class=md-ellipsis> Memory-efficient Data Structure for Procedural Maze Generation </span> </a> </li> <li class=md-nav__item> <a href=../../07-automatedtesting/ class=md-nav__link> <span class=md-ellipsis> AI for Testing </span> </a> </li> <li class=md-nav__item> <a href=../../09-minmax/ class=md-nav__link> <span class=md-ellipsis> MinMax </span> </a> </li> <li class="md-nav__item md-nav__item--pruned md-nav__item--nested"> <a href=../../assignments/ class=md-nav__link> <span class=md-ellipsis> Assignments </span> <span class="md-nav__icon md-icon"></span> </a> </li> </ul> </nav> </li> <li class="md-nav__item md-nav__item--pruned md-nav__item--nested"> <a href=../../../intro/ class=md-nav__link> <span class=md-ellipsis> Intro. Programming </span> <span class="md-nav__icon md-icon"></span> </a> </li> <li class="md-nav__item md-nav__item--pruned md-nav__item--nested"> <a href=../../../advanced/ class=md-nav__link> <span class=md-ellipsis> Adv. Programming </span> <span class="md-nav__icon md-icon"></span> </a> </li> <li class="md-nav__item md-nav__item--pruned md-nav__item--nested"> <a href=../../../algorithms/ class=md-nav__link> <span class=md-ellipsis> Algorithms </span> <span class="md-nav__icon md-icon"></span> </a> </li> <li class="md-nav__item md-nav__item--pruned md-nav__item--nested"> <a href=../../../portfolio/ class=md-nav__link> <span class=md-ellipsis> Portfolio </span> <span class="md-nav__icon md-icon"></span> </a> </li> <li class="md-nav__item md-nav__item--pruned md-nav__item--nested"> <a href=../../../blog/ class=md-nav__link> <span class=md-ellipsis> Blog </span> <span class="md-nav__icon md-icon"></span> </a> </li> <li class="md-nav__item md-nav__item--pruned md-nav__item--nested"> <a href=../../../support/50rs-button/ class=md-nav__link> <span class=md-ellipsis> Support </span> <span class="md-nav__icon md-icon"></span> </a> </li> </ul> </nav> </div> </div> </div> <div class=md-content data-md-component=content> <nav class=md-path aria-label=Navigation> <ol class=md-path__list> <li class=md-path__item> <a href=../../.. class=md-path__link> <span class=md-ellipsis> Home </span> </a> </li> <li class=md-path__item> <a href=../../ class=md-path__link> <span class=md-ellipsis> AI </span> </a> </li> </ol> </nav> <article class="md-content__inner md-typeset"> <a href=https://github.com/InfiniBrains/Awesome-GameDev-Resources/edit/main/docs/artificialintelligence/readings/spatial-quantization.md title="Edit this page" class="md-content__button md-icon"> <svg xmlns=http://www.w3.org/2000/svg viewbox="0 0 24 24"><path d="M10 20H6V4h7v5h5v3.1l2-2V8l-6-6H6c-1.1 0-2 .9-2 2v16c0 1.1.9 2 2 2h4zm10.2-7c.1 0 .3.1.4.2l1.3 1.3c.2.2.2.6 0 .8l-1 1-2.1-2.1 1-1c.1-.1.2-.2.4-.2m0 3.9L14.1 23H12v-2.1l6.1-6.1z"/></svg> </a> <h1 id=space-quantization>Space quantization<a class=headerlink href=#space-quantization title="Permanent link">&para;</a></h1><p style=color:#bdbdbd><i>Estimated time to read: 22 minutes</i></p> <p>Space quantization is a way to sample continuous space, and it can to be used in in many fields, such as Artificial Intelligence, Physics, Rendering, and more. Here we are going to focus primarily Spatial Quantization for AI, because it is the base for pathfinding, line of sight, field of view, and many other techniques.</p> <p>Some of the most common techniques for space quantization are: grids, voxels, graphs, quadtrees, octrees, KD-trees, BSP, Spatial Hashing and more. Another notable techniques are line of sight(or field of view), map flooding, caching, and movement zones.</p> <h1 id=grids>Grids<a class=headerlink href=#grids title="Permanent link">&para;</a></h1> <p>Grids are the most common technique for space quantization. It is a very simple technique, but it is very powerful. It consists in dividing the space in a grid of cells, and then we can use the cell coordinates to represent the space. The most common grid is the square grid, but we can use hexagonal and triangular grids, you might find some irregular shapes useful to exploit the space conformation better.</p> <h2 id=square-grid>Square Grid<a class=headerlink href=#square-grid title="Permanent link">&para;</a></h2> <p>The square grid is a regular grid, where the cells are squares. It is very simple to implement and understand.</p> <p>There are some ways to store data for squared grids. Arguably you could 2D arrays, arrays of arrays or vector of vectors, but depending on the way you implement it, it can hurt the performance. Example: if you use an array of arrays or vector of vectors, where every entry from de outer array is a pointer to the inner array, you will have a lot of cache misses, because the inner arrays are not contiguous in memory. </p> <h3 id=notes-on-cache-locality>Notes on cache locality<a class=headerlink href=#notes-on-cache-locality title="Permanent link">&para;</a></h3> <p>So in order do increase data locality for squared grids, you can use a single array, and then use the following formula to calculate the index of the cell. We call this strategy matrix flattening.</p> <div class="language-c++ highlight"><pre><span></span><code><span id=__span-0-1><a id=__codelineno-0-1 name=__codelineno-0-1 href=#__codelineno-0-1></a><span class=kt>int</span><span class=w> </span><span class=n>arrray</span><span class=p>[</span><span class=n>width</span><span class=w> </span><span class=o>*</span><span class=w> </span><span class=n>height</span><span class=p>];</span><span class=w> </span><span class=c1>// 1D array with the total size of the grid</span>
</span><span id=__span-0-2><a id=__codelineno-0-2 name=__codelineno-0-2 href=#__codelineno-0-2></a><span class=kt>int</span><span class=w> </span><span class=n>index</span><span class=w> </span><span class=o>=</span><span class=w> </span><span class=n>x</span><span class=w> </span><span class=o>+</span><span class=w> </span><span class=n>y</span><span class=w> </span><span class=o>*</span><span class=w> </span><span class=n>width</span><span class=p>;</span><span class=w> </span><span class=c1>// index of the cell at x,y</span>
</span></code></pre></div> <p>There is a catch here, given we usually represent points as X and Y coordinates, we need to be careful with the order of the coordinates. While you are iterating over all the matrix, you need to iterate over the Y coordinate first, and then the X coordinate. This is because the Y coordinate is the one that changes the most, so it is better to have it in the inner loop. By doing that, you will have better cache locality and effectively the index will be sequential.</p> <div class="language-c++ highlight"><pre><span></span><code><span id=__span-1-1><a id=__codelineno-1-1 name=__codelineno-1-1 href=#__codelineno-1-1></a><span class=n>vector</span><span class=o>&lt;</span><span class=n>YourStructure</span><span class=o>&gt;</span><span class=w> </span><span class=n>data</span><span class=p>;</span><span class=w> </span><span class=c1>// data is filled with some data elsewhere</span>
</span><span id=__span-1-2><a id=__codelineno-1-2 name=__codelineno-1-2 href=#__codelineno-1-2></a><span class=k>for</span><span class=p>(</span><span class=kt>int</span><span class=w> </span><span class=n>y</span><span class=w> </span><span class=o>=</span><span class=w> </span><span class=mi>0</span><span class=p>;</span><span class=w> </span><span class=n>y</span><span class=w> </span><span class=o>&lt;</span><span class=w> </span><span class=n>height</span><span class=p>;</span><span class=w> </span><span class=n>y</span><span class=o>++</span><span class=p>)</span><span class=w> </span><span class=p>{</span>
</span><span id=__span-1-3><a id=__codelineno-1-3 name=__codelineno-1-3 href=#__codelineno-1-3></a><span class=w>    </span><span class=k>for</span><span class=p>(</span><span class=kt>int</span><span class=w> </span><span class=n>x</span><span class=w> </span><span class=o>=</span><span class=w> </span><span class=mi>0</span><span class=p>;</span><span class=w> </span><span class=n>x</span><span class=w> </span><span class=o>&lt;</span><span class=w> </span><span class=n>width</span><span class=p>;</span><span class=w> </span><span class=n>x</span><span class=o>++</span><span class=p>)</span><span class=w> </span><span class=p>{</span>
</span><span id=__span-1-4><a id=__codelineno-1-4 name=__codelineno-1-4 href=#__codelineno-1-4></a><span class=w>        </span><span class=c1>// do something with the cell at index x,y</span>
</span><span id=__span-1-5><a id=__codelineno-1-5 name=__codelineno-1-5 href=#__codelineno-1-5></a><span class=w>        </span><span class=n>data</span><span class=p>[</span><span class=n>y</span><span class=w> </span><span class=o>*</span><span class=w> </span><span class=n>width</span><span class=w> </span><span class=o>+</span><span class=w> </span><span class=n>x</span><span class=p>]</span><span class=w> </span><span class=o>=</span><span class=w> </span><span class=n>yourstrucure</span><span class=p>;</span>
</span><span id=__span-1-6><a id=__codelineno-1-6 name=__codelineno-1-6 href=#__codelineno-1-6></a><span class=w>        </span><span class=c1>// it is the same as: data[y][x] = yourstructure;</span>
</span><span id=__span-1-7><a id=__codelineno-1-7 name=__codelineno-1-7 href=#__codelineno-1-7></a><span class=w>    </span><span class=p>}</span>
</span><span id=__span-1-8><a id=__codelineno-1-8 name=__codelineno-1-8 href=#__codelineno-1-8></a><span class=p>}</span>
</span></code></pre></div> <h3 id=quantization-and-dequantization-of-square-grids>Quantization and dequantization of square grids<a class=headerlink href=#quantization-and-dequantization-of-square-grids title="Permanent link">&para;</a></h3> <p>If your world is based on floats, you can use the square by using the floor function or just cast to integer type, because the default behavior of casting from float to integer is to floor it. Example: In the case of a quantization resolution of size of 1.0f, everything between 0 and 1 will be in the cell (0,0), everything between 1 and 2 will be in the cell (1,0), and so on.</p> <div class="language-c++ highlight"><pre><span></span><code><span id=__span-2-1><a id=__codelineno-2-1 name=__codelineno-2-1 href=#__codelineno-2-1></a><span class=n>Vector2int</span><span class=w> </span><span class=nf>quantize</span><span class=p>(</span><span class=n>Vector2f</span><span class=w> </span><span class=n>position</span><span class=p>,</span><span class=w> </span><span class=kt>float</span><span class=w> </span><span class=n>resolution</span><span class=p>)</span><span class=w> </span><span class=p>{</span>
</span><span id=__span-2-2><a id=__codelineno-2-2 name=__codelineno-2-2 href=#__codelineno-2-2></a><span class=w>    </span><span class=k>return</span><span class=w> </span><span class=n>Vector2int</span><span class=p>((</span><span class=kt>int</span><span class=p>)</span><span class=n>floor</span><span class=p>(</span><span class=n>position</span><span class=p>.</span><span class=n>x</span><span class=o>/</span><span class=n>resolution</span><span class=p>),</span><span class=w> </span><span class=p>(</span><span class=kt>int</span><span class=p>)</span><span class=n>floor</span><span class=p>(</span><span class=n>position</span><span class=p>.</span><span class=n>y</span><span class=o>/</span><span class=n>resolution</span><span class=p>));</span>
</span><span id=__span-2-3><a id=__codelineno-2-3 name=__codelineno-2-3 href=#__codelineno-2-3></a><span class=p>}</span>
</span></code></pre></div> <p>If you need to get the center of the cell in the world coordinates following the quantization resolution, you can use the following code.</p> <div class="language-c++ highlight"><pre><span></span><code><span id=__span-3-1><a id=__codelineno-3-1 name=__codelineno-3-1 href=#__codelineno-3-1></a><span class=n>Vector2f</span><span class=w> </span><span class=nf>dequantize</span><span class=p>(</span><span class=n>Vector2int</span><span class=w> </span><span class=n>index</span><span class=p>,</span><span class=w> </span><span class=kt>float</span><span class=w> </span><span class=n>resolution</span><span class=p>)</span><span class=w> </span><span class=p>{</span>
</span><span id=__span-3-2><a id=__codelineno-3-2 name=__codelineno-3-2 href=#__codelineno-3-2></a><span class=w>    </span><span class=k>return</span><span class=w> </span><span class=n>Vector2f</span><span class=p>((</span><span class=kt>float</span><span class=p>)</span><span class=n>index</span><span class=p>.</span><span class=n>x</span><span class=w> </span><span class=o>*</span><span class=w> </span><span class=n>resolution</span><span class=w> </span><span class=o>+</span><span class=w> </span><span class=n>resolution</span><span class=o>/</span><span class=mf>2.0f</span><span class=p>,</span><span class=w> </span><span class=p>(</span><span class=kt>float</span><span class=p>)</span><span class=n>index</span><span class=p>.</span><span class=n>y</span><span class=w> </span><span class=o>*</span><span class=w> </span><span class=n>resolution</span><span class=w> </span><span class=o>+</span><span class=w> </span><span class=n>resolution</span><span class=o>/</span><span class=mf>2.0f</span><span class=p>);</span>
</span><span id=__span-3-3><a id=__codelineno-3-3 name=__codelineno-3-3 href=#__codelineno-3-3></a><span class=p>}</span>
</span></code></pre></div> <p>If you need to get the corners of the cell following the quantization resolution, you can use the following code.</p> <div class="language-c++ highlight"><pre><span></span><code><span id=__span-4-1><a id=__codelineno-4-1 name=__codelineno-4-1 href=#__codelineno-4-1></a><span class=n>Rectangle2f</span><span class=w> </span><span class=nf>cell_bounds</span><span class=p>(</span><span class=n>Vector2int</span><span class=w> </span><span class=n>index</span><span class=p>,</span><span class=w> </span><span class=kt>float</span><span class=w> </span><span class=n>resolution</span><span class=p>)</span><span class=w> </span><span class=p>{</span>
</span><span id=__span-4-2><a id=__codelineno-4-2 name=__codelineno-4-2 href=#__codelineno-4-2></a><span class=w>    </span><span class=k>return</span><span class=w> </span><span class=p>{</span><span class=n>index</span><span class=p>.</span><span class=n>x</span><span class=w> </span><span class=o>*</span><span class=w> </span><span class=n>resolution</span><span class=p>,</span><span class=w> </span><span class=n>index</span><span class=p>.</span><span class=n>y</span><span class=w> </span><span class=o>*</span><span class=w> </span><span class=n>resolution</span><span class=p>,</span><span class=w> </span><span class=p>(</span><span class=n>index</span><span class=p>.</span><span class=n>x</span><span class=o>+</span><span class=mi>1</span><span class=p>)</span><span class=w> </span><span class=o>*</span><span class=w> </span><span class=n>resolution</span><span class=p>,</span><span class=w> </span><span class=p>(</span><span class=n>index</span><span class=p>.</span><span class=n>y</span><span class=o>+</span><span class=mi>1</span><span class=p>)</span><span class=w> </span><span class=o>*</span><span class=w> </span><span class=n>resolution</span><span class=p>};</span>
</span><span id=__span-4-3><a id=__codelineno-4-3 name=__codelineno-4-3 href=#__codelineno-4-3></a><span class=p>}</span>
</span></code></pre></div> <p>If you need to get the neighbors of a cell, you can use the following code.</p> <div class="language-c++ highlight"><pre><span></span><code><span id=__span-5-1><a id=__codelineno-5-1 name=__codelineno-5-1 href=#__codelineno-5-1></a><span class=n>std</span><span class=o>::</span><span class=n>vector</span><span class=o>&lt;</span><span class=n>Vector2int</span><span class=o>&gt;</span><span class=w> </span><span class=n>get_neighbors</span><span class=p>(</span><span class=n>Vector2int</span><span class=w> </span><span class=n>index</span><span class=p>)</span><span class=w> </span><span class=p>{</span>
</span><span id=__span-5-2><a id=__codelineno-5-2 name=__codelineno-5-2 href=#__codelineno-5-2></a><span class=w>    </span><span class=k>return</span><span class=w> </span><span class=p>{{</span><span class=n>index</span><span class=p>.</span><span class=n>x</span><span class=mi>-1</span><span class=p>,</span><span class=w> </span><span class=n>index</span><span class=p>.</span><span class=n>y</span><span class=p>},</span><span class=w> </span><span class=p>{</span><span class=n>index</span><span class=p>.</span><span class=n>x</span><span class=p>,</span><span class=w> </span><span class=n>index</span><span class=p>.</span><span class=n>y</span><span class=mi>-1</span><span class=p>},</span>
</span><span id=__span-5-3><a id=__codelineno-5-3 name=__codelineno-5-3 href=#__codelineno-5-3></a><span class=w>            </span><span class=p>{</span><span class=n>index</span><span class=p>.</span><span class=n>x</span><span class=o>+</span><span class=mi>1</span><span class=p>,</span><span class=w> </span><span class=n>index</span><span class=p>.</span><span class=n>y</span><span class=p>},</span><span class=w> </span><span class=p>{</span><span class=n>index</span><span class=p>.</span><span class=n>x</span><span class=p>,</span><span class=w> </span><span class=n>index</span><span class=p>.</span><span class=n>y</span><span class=o>+</span><span class=mi>1</span><span class=p>}};</span>
</span><span id=__span-5-4><a id=__codelineno-5-4 name=__codelineno-5-4 href=#__codelineno-5-4></a><span class=p>}</span>
</span></code></pre></div> <p>We already understood the idea of matrix flattening to improve efficiency, we can use it to represent a maze. But in a maze, we have walls to </p> <p>Imagine that you are willing to be as memory efficient and more cache friendly as possible. You can use a single array to store the maze, and you can use the following formula to convert from matrix indexes to the index of the cell in the array.</p> <div class="language-c++ highlight"><pre><span></span><code><span id=__span-6-1><a id=__codelineno-6-1 name=__codelineno-6-1 href=#__codelineno-6-1></a><span class=cp>## Hexagonal Grid</span>
</span><span id=__span-6-2><a id=__codelineno-6-2 name=__codelineno-6-2 href=#__codelineno-6-2></a>
</span><span id=__span-6-3><a id=__codelineno-6-3 name=__codelineno-6-3 href=#__codelineno-6-3></a><span class=n>Hexagonal</span><span class=w> </span><span class=n>grid</span><span class=w> </span><span class=n>is</span><span class=w> </span><span class=n>an</span><span class=w> </span><span class=n>extension</span><span class=w> </span><span class=n>of</span><span class=w> </span><span class=n>a</span><span class=w> </span><span class=n>square</span><span class=w> </span><span class=n>grid</span><span class=p>,</span><span class=w> </span><span class=n>but</span><span class=w> </span><span class=n>the</span><span class=w> </span><span class=n>cells</span><span class=w> </span><span class=n>are</span><span class=w> </span><span class=n>hexagons</span><span class=p>.</span><span class=w> </span><span class=n>It</span><span class=w> </span><span class=n>feels</span><span class=w> </span><span class=n>nicer</span><span class=w> </span><span class=n>to</span><span class=w> </span><span class=n>human</span><span class=w> </span><span class=n>eyes</span><span class=w> </span><span class=n>because</span><span class=w> </span><span class=n>we</span><span class=w> </span><span class=n>have</span><span class=w> </span><span class=n>more</span><span class=w> </span><span class=n>equally</span><span class=w> </span><span class=n>distant</span><span class=w> </span><span class=n>neighbors</span><span class=p>.</span><span class=w> </span><span class=n>If</span><span class=w> </span><span class=n>used</span><span class=w> </span><span class=n>as</span><span class=w> </span><span class=n>subtract</span><span class=w> </span><span class=k>for</span><span class=w> </span><span class=n>pathfinding</span><span class=p>,</span><span class=w> </span><span class=n>it</span><span class=w> </span><span class=n>can</span><span class=w> </span><span class=n>be</span><span class=w> </span><span class=n>more</span><span class=w> </span><span class=n>efficient</span><span class=w> </span><span class=n>because</span><span class=w> </span><span class=n>the</span><span class=w> </span><span class=n>path</span><span class=w> </span><span class=n>can</span><span class=w> </span><span class=n>be</span><span class=w> </span><span class=n>more</span><span class=w> </span><span class=n>straight</span><span class=p>.</span>
</span><span id=__span-6-4><a id=__codelineno-6-4 name=__codelineno-6-4 href=#__codelineno-6-4></a>
</span><span id=__span-6-5><a id=__codelineno-6-5 name=__codelineno-6-5 href=#__codelineno-6-5></a><span class=n>It</span><span class=w> </span><span class=n>can</span><span class=w> </span><span class=n>be</span><span class=w> </span><span class=n>implemented</span><span class=w> </span><span class=n>as</span><span class=w> </span><span class=n>single</span><span class=w> </span><span class=n>dimension</span><span class=w> </span><span class=n>array</span><span class=p>,</span><span class=w> </span><span class=n>but</span><span class=w> </span><span class=n>you</span><span class=w> </span><span class=n>need</span><span class=w> </span><span class=n>to</span><span class=w> </span><span class=n>be</span><span class=w> </span><span class=n>careful</span><span class=w> </span><span class=n>with</span><span class=w> </span><span class=n>shift</span><span class=w> </span><span class=n>that</span><span class=w> </span><span class=n>happens</span><span class=w> </span><span class=n>in</span><span class=w> </span><span class=n>different</span><span class=w> </span><span class=n>odd</span><span class=w> </span><span class=k>or</span><span class=w> </span><span class=n>even</span><span class=w> </span><span class=n>indexes</span><span class=p>.</span><span class=w> </span><span class=n>You</span><span class=w> </span><span class=n>can</span><span class=w> </span><span class=n>use</span><span class=w> </span><span class=n>the</span><span class=w> </span><span class=n>following</span><span class=w> </span><span class=n>formula</span><span class=w> </span><span class=n>to</span><span class=w> </span><span class=n>calculate</span><span class=w> </span><span class=n>the</span><span class=w> </span><span class=n>index</span><span class=w> </span><span class=n>of</span><span class=w> </span><span class=n>the</span><span class=w> </span><span class=n>cell</span><span class=p>.</span><span class=w> </span><span class=n>In</span><span class=w> </span><span class=k>this</span><span class=w> </span><span class=n>world</span><span class=w> </span><span class=n>quantization</span><span class=w> </span><span class=n>can</span><span class=w> </span><span class=n>be</span><span class=w> </span><span class=n>in</span><span class=w> </span><span class=mi>4</span><span class=w> </span><span class=n>conformations</span><span class=p>,</span><span class=w> </span><span class=n>depending</span><span class=w> </span><span class=n>on</span><span class=w> </span><span class=n>the</span><span class=w> </span><span class=n>rotation</span><span class=w> </span><span class=n>of</span><span class=w> </span><span class=n>the</span><span class=w> </span><span class=n>hexagon</span><span class=w> </span><span class=k>and</span><span class=w> </span><span class=n>the</span><span class=w> </span><span class=n>alignment</span><span class=w> </span><span class=n>of</span><span class=w> </span><span class=n>the</span><span class=w> </span><span class=n>first</span><span class=w> </span><span class=n>cell</span><span class=p>.</span>
</span><span id=__span-6-6><a id=__codelineno-6-6 name=__codelineno-6-6 href=#__codelineno-6-6></a>
</span><span id=__span-6-7><a id=__codelineno-6-7 name=__codelineno-6-7 href=#__codelineno-6-7></a><span class=mf>1.</span><span class=w> </span><span class=n>Point</span><span class=w> </span><span class=n>pointy</span><span class=w> </span><span class=n>top</span><span class=w> </span><span class=n>hexagon</span><span class=w> </span><span class=n>with</span><span class=w> </span><span class=n>first</span><span class=w> </span><span class=n>line</span><span class=w> </span><span class=n>aligned</span><span class=w> </span><span class=n>to</span><span class=w> </span><span class=n>the</span><span class=w> </span><span class=n>left</span><span class=o>:</span>
</span><span id=__span-6-8><a id=__codelineno-6-8 name=__codelineno-6-8 href=#__codelineno-6-8></a><span class=err>```</span><span class=w> </span><span class=n>text</span>
</span><span id=__span-6-9><a id=__codelineno-6-9 name=__codelineno-6-9 href=#__codelineno-6-9></a><span class=w>  </span><span class=o>/</span><span class=w> </span><span class=err>\</span><span class=w> </span><span class=o>/</span><span class=w> </span><span class=err>\</span><span class=w> </span><span class=o>/</span><span class=w> </span><span class=err>\</span><span class=w> </span>
</span><span id=__span-6-10><a id=__codelineno-6-10 name=__codelineno-6-10 href=#__codelineno-6-10></a><span class=w> </span><span class=o>|</span><span class=w> </span><span class=n>A</span><span class=w> </span><span class=o>|</span><span class=w> </span><span class=n>B</span><span class=w> </span><span class=o>|</span><span class=w> </span><span class=n>C</span><span class=w> </span><span class=o>|</span>
</span><span id=__span-6-11><a id=__codelineno-6-11 name=__codelineno-6-11 href=#__codelineno-6-11></a><span class=w>  </span><span class=err>\</span><span class=w> </span><span class=o>/</span><span class=w> </span><span class=err>\</span><span class=w> </span><span class=o>/</span><span class=w> </span><span class=err>\</span><span class=w> </span><span class=o>/</span><span class=w> </span>\
</span><span id=__span-6-12><a id=__codelineno-6-12 name=__codelineno-6-12 href=#__codelineno-6-12></a><span class=w>   </span><span class=o>|</span><span class=w> </span><span class=n>D</span><span class=w> </span><span class=o>|</span><span class=w> </span><span class=n>E</span><span class=w> </span><span class=o>|</span><span class=w> </span><span class=n>F</span><span class=w> </span><span class=o>|</span>
</span><span id=__span-6-13><a id=__codelineno-6-13 name=__codelineno-6-13 href=#__codelineno-6-13></a><span class=w>  </span><span class=o>/</span><span class=w> </span><span class=err>\</span><span class=w> </span><span class=o>/</span><span class=w> </span><span class=err>\</span><span class=w> </span><span class=o>/</span><span class=w> </span><span class=err>\</span><span class=w> </span><span class=o>/</span>
</span><span id=__span-6-14><a id=__codelineno-6-14 name=__codelineno-6-14 href=#__codelineno-6-14></a><span class=w> </span><span class=o>|</span><span class=w> </span><span class=n>G</span><span class=w> </span><span class=o>|</span><span class=w> </span><span class=n>H</span><span class=w> </span><span class=o>|</span><span class=w> </span><span class=n>I</span><span class=w> </span><span class=o>|</span>
</span><span id=__span-6-15><a id=__codelineno-6-15 name=__codelineno-6-15 href=#__codelineno-6-15></a><span class=w>  </span><span class=err>\</span><span class=w> </span><span class=o>/</span><span class=w> </span><span class=err>\</span><span class=w> </span><span class=o>/</span><span class=w> </span><span class=err>\</span><span class=w> </span><span class=o>/</span><span class=w> </span>
</span></code></pre></div> <ol> <li>Point pointy top hexagon with first line aligned to the right <div class="language-text highlight"><pre><span></span><code><span id=__span-7-1><a id=__codelineno-7-1 name=__codelineno-7-1 href=#__codelineno-7-1></a>    / \ / \ / \
</span><span id=__span-7-2><a id=__codelineno-7-2 name=__codelineno-7-2 href=#__codelineno-7-2></a>   | A | B | C |
</span><span id=__span-7-3><a id=__codelineno-7-3 name=__codelineno-7-3 href=#__codelineno-7-3></a>  / \ / \ / \ / 
</span><span id=__span-7-4><a id=__codelineno-7-4 name=__codelineno-7-4 href=#__codelineno-7-4></a> | D | E | F |
</span><span id=__span-7-5><a id=__codelineno-7-5 name=__codelineno-7-5 href=#__codelineno-7-5></a>  \ / \ / \ / \
</span><span id=__span-7-6><a id=__codelineno-7-6 name=__codelineno-7-6 href=#__codelineno-7-6></a>   | G | H | I |
</span><span id=__span-7-7><a id=__codelineno-7-7 name=__codelineno-7-7 href=#__codelineno-7-7></a>    \ / \ / \ /
</span></code></pre></div></li> <li>Flat top hexagon with first column aligned to the top: <div class="language-text highlight"><pre><span></span><code><span id=__span-8-1><a id=__codelineno-8-1 name=__codelineno-8-1 href=#__codelineno-8-1></a> __    __
</span><span id=__span-8-2><a id=__codelineno-8-2 name=__codelineno-8-2 href=#__codelineno-8-2></a>/A \__/C \
</span><span id=__span-8-3><a id=__codelineno-8-3 name=__codelineno-8-3 href=#__codelineno-8-3></a>\__/B \__/
</span><span id=__span-8-4><a id=__codelineno-8-4 name=__codelineno-8-4 href=#__codelineno-8-4></a>/D \__/F \
</span><span id=__span-8-5><a id=__codelineno-8-5 name=__codelineno-8-5 href=#__codelineno-8-5></a>\__/E \__/
</span><span id=__span-8-6><a id=__codelineno-8-6 name=__codelineno-8-6 href=#__codelineno-8-6></a>/G \__/I \
</span><span id=__span-8-7><a id=__codelineno-8-7 name=__codelineno-8-7 href=#__codelineno-8-7></a>\__/H \__/
</span><span id=__span-8-8><a id=__codelineno-8-8 name=__codelineno-8-8 href=#__codelineno-8-8></a>   \__/
</span></code></pre></div></li> <li>Flat top hexagon with first column aligned to the bottom: <div class="language-text highlight"><pre><span></span><code><span id=__span-9-1><a id=__codelineno-9-1 name=__codelineno-9-1 href=#__codelineno-9-1></a>     __
</span><span id=__span-9-2><a id=__codelineno-9-2 name=__codelineno-9-2 href=#__codelineno-9-2></a>  __/B \__ 
</span><span id=__span-9-3><a id=__codelineno-9-3 name=__codelineno-9-3 href=#__codelineno-9-3></a> /A \__/C \
</span><span id=__span-9-4><a id=__codelineno-9-4 name=__codelineno-9-4 href=#__codelineno-9-4></a> \__/E \__/
</span><span id=__span-9-5><a id=__codelineno-9-5 name=__codelineno-9-5 href=#__codelineno-9-5></a> /D \__/F \
</span><span id=__span-9-6><a id=__codelineno-9-6 name=__codelineno-9-6 href=#__codelineno-9-6></a> \__/H \__/
</span><span id=__span-9-7><a id=__codelineno-9-7 name=__codelineno-9-7 href=#__codelineno-9-7></a> /G \__/I \
</span><span id=__span-9-8><a id=__codelineno-9-8 name=__codelineno-9-8 href=#__codelineno-9-8></a> \__/  \__/
</span></code></pre></div></li> </ol> <h3 id=quantization-and-dequantization-of-hexagonal-grids>Quantization and dequantization of hexagonal grids<a class=headerlink href=#quantization-and-dequantization-of-hexagonal-grids title="Permanent link">&para;</a></h3> <p>For simplicity, we are going to use the first conformation, where the first line is aligned to the left, and the hexagons are pointy top. The quantization is done by using the following formula.</p> <div class="language-c++ highlight"><pre><span></span><code><span id=__span-10-1><a id=__codelineno-10-1 name=__codelineno-10-1 href=#__codelineno-10-1></a><span class=c1>// I am assuming that the hexagon is pointy top, and the first line is aligned to the left</span>
</span><span id=__span-10-2><a id=__codelineno-10-2 name=__codelineno-10-2 href=#__codelineno-10-2></a><span class=c1>// I am also assuming that the hexagon is centered in the cell, and the top left corner is at (0,0), </span>
</span><span id=__span-10-3><a id=__codelineno-10-3 name=__codelineno-10-3 href=#__codelineno-10-3></a><span class=c1>// y axis is pointing down and x axis is pointing right</span>
</span><span id=__span-10-4><a id=__codelineno-10-4 name=__codelineno-10-4 href=#__codelineno-10-4></a><span class=c1>// this dont work for all the cases, but it is a good approximation for locations near the center of the hexagon</span>
</span><span id=__span-10-5><a id=__codelineno-10-5 name=__codelineno-10-5 href=#__codelineno-10-5></a><span class=cm>/*</span>
</span><span id=__span-10-6><a id=__codelineno-10-6 name=__codelineno-10-6 href=#__codelineno-10-6></a><span class=cm>  / \ / \ / \ </span>
</span><span id=__span-10-7><a id=__codelineno-10-7 name=__codelineno-10-7 href=#__codelineno-10-7></a><span class=cm> | A | B | C |</span>
</span><span id=__span-10-8><a id=__codelineno-10-8 name=__codelineno-10-8 href=#__codelineno-10-8></a><span class=cm>  \ / \ / \ / \</span>
</span><span id=__span-10-9><a id=__codelineno-10-9 name=__codelineno-10-9 href=#__codelineno-10-9></a><span class=cm>   | D | E | F |</span>
</span><span id=__span-10-10><a id=__codelineno-10-10 name=__codelineno-10-10 href=#__codelineno-10-10></a><span class=cm>  / \ / \ / \ /</span>
</span><span id=__span-10-11><a id=__codelineno-10-11 name=__codelineno-10-11 href=#__codelineno-10-11></a><span class=cm> | G | H | I |</span>
</span><span id=__span-10-12><a id=__codelineno-10-12 name=__codelineno-10-12 href=#__codelineno-10-12></a><span class=cm>  \ / \ / \ /</span>
</span><span id=__span-10-13><a id=__codelineno-10-13 name=__codelineno-10-13 href=#__codelineno-10-13></a><span class=cm> */</span>
</span><span id=__span-10-14><a id=__codelineno-10-14 name=__codelineno-10-14 href=#__codelineno-10-14></a><span class=n>Vector2int</span><span class=w> </span><span class=nf>quantize</span><span class=p>(</span><span class=n>Vector2f</span><span class=w> </span><span class=n>position</span><span class=p>,</span><span class=w> </span><span class=kt>float</span><span class=w> </span><span class=n>hexagonSide</span><span class=p>)</span><span class=w> </span><span class=p>{</span>
</span><span id=__span-10-15><a id=__codelineno-10-15 name=__codelineno-10-15 href=#__codelineno-10-15></a><span class=w>    </span><span class=kt>int</span><span class=w> </span><span class=n>y</span><span class=w> </span><span class=o>=</span><span class=w> </span><span class=p>(</span><span class=n>position</span><span class=p>.</span><span class=n>y</span><span class=w> </span><span class=o>-</span><span class=w> </span><span class=n>hexagonSide</span><span class=p>)</span><span class=o>/</span><span class=p>(</span><span class=n>hexagonSide</span><span class=w> </span><span class=o>*</span><span class=w> </span><span class=mi>2</span><span class=p>);</span>
</span><span id=__span-10-16><a id=__codelineno-10-16 name=__codelineno-10-16 href=#__codelineno-10-16></a><span class=w>    </span><span class=kt>int</span><span class=w> </span><span class=n>x</span><span class=w> </span><span class=o>=</span><span class=w> </span><span class=n>y</span><span class=o>%</span><span class=mi>2</span><span class=o>==</span><span class=mi>0</span><span class=w> </span><span class=o>?</span>
</span><span id=__span-10-17><a id=__codelineno-10-17 name=__codelineno-10-17 href=#__codelineno-10-17></a><span class=w>      </span><span class=p>(</span><span class=n>position</span><span class=p>.</span><span class=n>x</span><span class=w> </span><span class=o>-</span><span class=w> </span><span class=n>hexagonSide</span><span class=w> </span><span class=o>*</span><span class=w> </span><span class=n>sqrt3over2</span><span class=p>)</span><span class=w> </span><span class=o>/</span><span class=w> </span><span class=p>(</span><span class=n>hexagonSide</span><span class=w> </span><span class=o>*</span><span class=w> </span><span class=n>sqrt3over2</span><span class=w> </span><span class=o>*</span><span class=w> </span><span class=mi>2</span><span class=p>)</span><span class=w> </span><span class=o>:</span><span class=w> </span><span class=c1>// even lines</span>
</span><span id=__span-10-18><a id=__codelineno-10-18 name=__codelineno-10-18 href=#__codelineno-10-18></a><span class=w>      </span><span class=p>(</span><span class=n>position</span><span class=p>.</span><span class=n>x</span><span class=w> </span><span class=o>-</span><span class=w> </span><span class=n>hexagonSide</span><span class=w> </span><span class=o>*</span><span class=w> </span><span class=n>sqrt3over2</span><span class=w> </span><span class=o>*</span><span class=w> </span><span class=mi>2</span><span class=p>)</span><span class=o>/</span><span class=p>(</span><span class=n>hexagonSide</span><span class=w> </span><span class=o>*</span><span class=w> </span><span class=n>sqrt3over2</span><span class=w> </span><span class=o>*</span><span class=w> </span><span class=mi>2</span><span class=p>)</span><span class=w> </span><span class=c1>// odd lines</span>
</span><span id=__span-10-19><a id=__codelineno-10-19 name=__codelineno-10-19 href=#__codelineno-10-19></a><span class=w>    </span><span class=k>return</span><span class=w> </span><span class=n>Vector2int</span><span class=p>(</span><span class=n>x</span><span class=p>,</span><span class=w> </span><span class=n>y</span><span class=p>);</span>
</span><span id=__span-10-20><a id=__codelineno-10-20 name=__codelineno-10-20 href=#__codelineno-10-20></a><span class=p>}</span>
</span><span id=__span-10-21><a id=__codelineno-10-21 name=__codelineno-10-21 href=#__codelineno-10-21></a><span class=n>Vector2f</span><span class=w> </span><span class=nf>dequantize</span><span class=p>(</span><span class=n>Vector2int</span><span class=w> </span><span class=n>index</span><span class=p>,</span><span class=w> </span><span class=kt>float</span><span class=w> </span><span class=n>hexagonSide</span><span class=p>)</span><span class=w> </span><span class=p>{</span>
</span><span id=__span-10-22><a id=__codelineno-10-22 name=__codelineno-10-22 href=#__codelineno-10-22></a><span class=w>    </span><span class=k>return</span><span class=w> </span><span class=n>Vector2f</span><span class=p>(</span><span class=n>index</span><span class=p>.</span><span class=n>y</span><span class=o>%</span><span class=mi>2</span><span class=o>==</span><span class=mi>0</span><span class=w> </span><span class=o>?</span><span class=w> </span>
</span><span id=__span-10-23><a id=__codelineno-10-23 name=__codelineno-10-23 href=#__codelineno-10-23></a><span class=w>      </span><span class=n>hexagonSide</span><span class=w> </span><span class=o>*</span><span class=w> </span><span class=n>sqrt3over2</span><span class=w> </span><span class=o>+</span><span class=w> </span><span class=n>index</span><span class=p>.</span><span class=n>x</span><span class=w> </span><span class=o>*</span><span class=w> </span><span class=n>hexagonSide</span><span class=w> </span><span class=o>*</span><span class=w> </span><span class=n>sqrt3over2</span><span class=w> </span><span class=o>*</span><span class=w> </span><span class=mi>2</span><span class=w> </span><span class=o>:</span><span class=w> </span><span class=c1>// even lines</span>
</span><span id=__span-10-24><a id=__codelineno-10-24 name=__codelineno-10-24 href=#__codelineno-10-24></a><span class=w>      </span><span class=n>hexagonSide</span><span class=w> </span><span class=o>*</span><span class=w> </span><span class=n>sqrt3over2</span><span class=w> </span><span class=o>*</span><span class=w> </span><span class=mi>2</span><span class=w> </span><span class=o>+</span><span class=w> </span><span class=n>index</span><span class=p>.</span><span class=n>x</span><span class=w> </span><span class=o>*</span><span class=w> </span><span class=n>hexagonSide</span><span class=w> </span><span class=o>*</span><span class=w> </span><span class=n>sqrt3over2</span><span class=w> </span><span class=o>*</span><span class=w> </span><span class=mi>2</span><span class=p>,</span><span class=w> </span><span class=c1>// odd lines</span>
</span><span id=__span-10-25><a id=__codelineno-10-25 name=__codelineno-10-25 href=#__codelineno-10-25></a><span class=w>      </span><span class=n>hexagonSide</span><span class=w> </span><span class=o>+</span><span class=w> </span><span class=n>index</span><span class=p>.</span><span class=n>y</span><span class=w> </span><span class=o>*</span><span class=w> </span><span class=n>hexagonSide</span><span class=w> </span><span class=o>*</span><span class=w> </span><span class=mi>2</span><span class=p>);</span>
</span><span id=__span-10-26><a id=__codelineno-10-26 name=__codelineno-10-26 href=#__codelineno-10-26></a><span class=p>}</span>
</span></code></pre></div> <p>You will have to figure out the formula for the other conformations. Or send a merge request to this repository adding more information.</p> <h1 id=voxels-and-grid-3d>Voxels and Grid 3D<a class=headerlink href=#voxels-and-grid-3d title="Permanent link">&para;</a></h1> <p>Grids in 3D works the same way as in 2D, but you need to use 3D vectors/arrays or voxel volumes. Most concepts applies here. If you want to expand this section, send a merge request.</p> <h1 id=quadtree>Quadtree<a class=headerlink href=#quadtree title="Permanent link">&para;</a></h1> <p>Quadtree is a tree data structure where each node has 4 children. It is used to partition a space in 2D. It is used to optimize collision detection, pathfinding, and other algorithms that need to iterate over a space. It is also used to optimize rendering, because you can render only the visible part of the space.</p> <h2 id=quadtree-implementation>Quadtree implementation<a class=headerlink href=#quadtree-implementation title="Permanent link">&para;</a></h2> <p>Quadtree is a recursive data structure, so you can implement it using a recursive data structure. The following code is a simple implementation of a quadtree.</p> <div class="language-c++ highlight"><pre><span></span><code><span id=__span-11-1><a id=__codelineno-11-1 name=__codelineno-11-1 href=#__codelineno-11-1></a><span class=c1>// this code is not tested, but it should work. It is just an example and send a merge request if you find any errors.</span>
</span><span id=__span-11-2><a id=__codelineno-11-2 name=__codelineno-11-2 href=#__codelineno-11-2></a><span class=c1>// node</span>
</span><span id=__span-11-3><a id=__codelineno-11-3 name=__codelineno-11-3 href=#__codelineno-11-3></a><span class=k>template</span><span class=o>&lt;</span><span class=k>class</span><span class=w> </span><span class=nc>T</span><span class=o>&gt;</span>
</span><span id=__span-11-4><a id=__codelineno-11-4 name=__codelineno-11-4 href=#__codelineno-11-4></a><span class=k>struct</span><span class=w> </span><span class=nc>DataAtPosition</span><span class=w> </span><span class=p>{</span>
</span><span id=__span-11-5><a id=__codelineno-11-5 name=__codelineno-11-5 href=#__codelineno-11-5></a><span class=w>    </span><span class=n>Vector2f</span><span class=w> </span><span class=n>center</span><span class=p>;</span>
</span><span id=__span-11-6><a id=__codelineno-11-6 name=__codelineno-11-6 href=#__codelineno-11-6></a><span class=w>    </span><span class=n>T</span><span class=w> </span><span class=n>data</span><span class=p>;</span>
</span><span id=__span-11-7><a id=__codelineno-11-7 name=__codelineno-11-7 href=#__codelineno-11-7></a><span class=p>};</span>
</span><span id=__span-11-8><a id=__codelineno-11-8 name=__codelineno-11-8 href=#__codelineno-11-8></a>
</span><span id=__span-11-9><a id=__codelineno-11-9 name=__codelineno-11-9 href=#__codelineno-11-9></a><span class=k>template</span><span class=o>&lt;</span><span class=k>class</span><span class=w> </span><span class=nc>T</span><span class=o>&gt;</span>
</span><span id=__span-11-10><a id=__codelineno-11-10 name=__codelineno-11-10 href=#__codelineno-11-10></a><span class=k>struct</span><span class=w> </span><span class=nc>QuadtreeNode</span><span class=w> </span><span class=p>{</span>
</span><span id=__span-11-11><a id=__codelineno-11-11 name=__codelineno-11-11 href=#__codelineno-11-11></a><span class=w>    </span><span class=n>Rectangle2f</span><span class=w> </span><span class=n>bounds</span><span class=p>;</span>
</span><span id=__span-11-12><a id=__codelineno-11-12 name=__codelineno-11-12 href=#__codelineno-11-12></a><span class=w>    </span><span class=n>std</span><span class=o>::</span><span class=n>vector</span><span class=o>&lt;</span><span class=n>DataAtPosition</span><span class=o>&lt;</span><span class=n>T</span><span class=o>&gt;&gt;</span><span class=w> </span><span class=n>data</span><span class=p>;</span>
</span><span id=__span-11-13><a id=__codelineno-11-13 name=__codelineno-11-13 href=#__codelineno-11-13></a><span class=w>    </span><span class=n>std</span><span class=o>::</span><span class=n>vector</span><span class=o>&lt;</span><span class=n>QuadtreeNode</span><span class=o>&lt;</span><span class=n>T</span><span class=o>&gt;&gt;</span><span class=w> </span><span class=n>children</span><span class=p>;</span>
</span><span id=__span-11-14><a id=__codelineno-11-14 name=__codelineno-11-14 href=#__codelineno-11-14></a><span class=p>};</span>
</span><span id=__span-11-15><a id=__codelineno-11-15 name=__codelineno-11-15 href=#__codelineno-11-15></a>
</span><span id=__span-11-16><a id=__codelineno-11-16 name=__codelineno-11-16 href=#__codelineno-11-16></a><span class=c1>// insert</span>
</span><span id=__span-11-17><a id=__codelineno-11-17 name=__codelineno-11-17 href=#__codelineno-11-17></a><span class=k>template</span><span class=o>&lt;</span><span class=k>class</span><span class=w> </span><span class=nc>T</span><span class=o>&gt;</span>
</span><span id=__span-11-18><a id=__codelineno-11-18 name=__codelineno-11-18 href=#__codelineno-11-18></a><span class=kt>void</span><span class=w> </span><span class=n>insert</span><span class=p>(</span><span class=n>QuadtreeNode</span><span class=o>&lt;</span><span class=n>T</span><span class=o>&gt;&amp;</span><span class=w> </span><span class=n>root</span><span class=p>,</span><span class=w> </span><span class=n>DataAtPosition</span><span class=o>&lt;</span><span class=n>T</span><span class=o>&gt;</span><span class=w> </span><span class=n>data</span><span class=p>)</span><span class=w> </span><span class=p>{</span>
</span><span id=__span-11-19><a id=__codelineno-11-19 name=__codelineno-11-19 href=#__codelineno-11-19></a><span class=w>    </span><span class=k>if</span><span class=w> </span><span class=p>(</span><span class=n>root</span><span class=p>.</span><span class=n>children</span><span class=p>.</span><span class=n>empty</span><span class=p>())</span><span class=w> </span><span class=p>{</span>
</span><span id=__span-11-20><a id=__codelineno-11-20 name=__codelineno-11-20 href=#__codelineno-11-20></a><span class=w>        </span><span class=n>root</span><span class=p>.</span><span class=n>data</span><span class=p>.</span><span class=n>push_back</span><span class=p>(</span><span class=n>data</span><span class=p>);</span>
</span><span id=__span-11-21><a id=__codelineno-11-21 name=__codelineno-11-21 href=#__codelineno-11-21></a><span class=w>        </span><span class=k>if</span><span class=w> </span><span class=p>(</span><span class=n>root</span><span class=p>.</span><span class=n>data</span><span class=p>.</span><span class=n>size</span><span class=p>()</span><span class=w> </span><span class=o>&gt;</span><span class=w> </span><span class=mi>4</span><span class=p>)</span><span class=w> </span><span class=p>{</span>
</span><span id=__span-11-22><a id=__codelineno-11-22 name=__codelineno-11-22 href=#__codelineno-11-22></a><span class=w>            </span><span class=n>root</span><span class=p>.</span><span class=n>children</span><span class=p>.</span><span class=n>resize</span><span class=p>(</span><span class=mi>4</span><span class=p>);</span>
</span><span id=__span-11-23><a id=__codelineno-11-23 name=__codelineno-11-23 href=#__codelineno-11-23></a><span class=w>            </span><span class=k>for</span><span class=w> </span><span class=p>(</span><span class=kt>int</span><span class=w> </span><span class=n>i</span><span class=w> </span><span class=o>=</span><span class=w> </span><span class=mi>0</span><span class=p>;</span><span class=w> </span><span class=n>i</span><span class=w> </span><span class=o>&lt;</span><span class=w> </span><span class=mi>4</span><span class=p>;</span><span class=w> </span><span class=o>++</span><span class=n>i</span><span class=p>)</span><span class=w> </span><span class=p>{</span>
</span><span id=__span-11-24><a id=__codelineno-11-24 name=__codelineno-11-24 href=#__codelineno-11-24></a><span class=w>                </span><span class=n>root</span><span class=p>.</span><span class=n>children</span><span class=p>[</span><span class=n>i</span><span class=p>].</span><span class=n>bounds</span><span class=w> </span><span class=o>=</span><span class=w> </span><span class=n>root</span><span class=p>.</span><span class=n>bounds</span><span class=p>;</span>
</span><span id=__span-11-25><a id=__codelineno-11-25 name=__codelineno-11-25 href=#__codelineno-11-25></a><span class=w>            </span><span class=p>}</span>
</span><span id=__span-11-26><a id=__codelineno-11-26 name=__codelineno-11-26 href=#__codelineno-11-26></a><span class=w>            </span><span class=n>root</span><span class=p>.</span><span class=n>children</span><span class=p>[</span><span class=mi>0</span><span class=p>].</span><span class=n>bounds</span><span class=p>.</span><span class=n>max</span><span class=p>.</span><span class=n>x</span><span class=w> </span><span class=o>=</span><span class=w> </span><span class=n>root</span><span class=p>.</span><span class=n>bounds</span><span class=p>.</span><span class=n>center</span><span class=p>().</span><span class=n>x</span><span class=p>;</span><span class=w> </span><span class=c1>// top left</span>
</span><span id=__span-11-27><a id=__codelineno-11-27 name=__codelineno-11-27 href=#__codelineno-11-27></a><span class=w>            </span><span class=n>root</span><span class=p>.</span><span class=n>children</span><span class=p>[</span><span class=mi>0</span><span class=p>].</span><span class=n>bounds</span><span class=p>.</span><span class=n>max</span><span class=p>.</span><span class=n>y</span><span class=w> </span><span class=o>=</span><span class=w> </span><span class=n>root</span><span class=p>.</span><span class=n>bounds</span><span class=p>.</span><span class=n>center</span><span class=p>().</span><span class=n>y</span><span class=p>;</span><span class=w> </span><span class=c1>// top left</span>
</span><span id=__span-11-28><a id=__codelineno-11-28 name=__codelineno-11-28 href=#__codelineno-11-28></a><span class=w>            </span><span class=n>root</span><span class=p>.</span><span class=n>children</span><span class=p>[</span><span class=mi>1</span><span class=p>].</span><span class=n>bounds</span><span class=p>.</span><span class=n>min</span><span class=p>.</span><span class=n>x</span><span class=w> </span><span class=o>=</span><span class=w> </span><span class=n>root</span><span class=p>.</span><span class=n>bounds</span><span class=p>.</span><span class=n>center</span><span class=p>().</span><span class=n>x</span><span class=p>;</span><span class=w> </span><span class=c1>// top right</span>
</span><span id=__span-11-29><a id=__codelineno-11-29 name=__codelineno-11-29 href=#__codelineno-11-29></a><span class=w>            </span><span class=n>root</span><span class=p>.</span><span class=n>children</span><span class=p>[</span><span class=mi>1</span><span class=p>].</span><span class=n>bounds</span><span class=p>.</span><span class=n>max</span><span class=p>.</span><span class=n>y</span><span class=w> </span><span class=o>=</span><span class=w> </span><span class=n>root</span><span class=p>.</span><span class=n>bounds</span><span class=p>.</span><span class=n>center</span><span class=p>().</span><span class=n>y</span><span class=p>;</span><span class=w> </span><span class=c1>// top right</span>
</span><span id=__span-11-30><a id=__codelineno-11-30 name=__codelineno-11-30 href=#__codelineno-11-30></a><span class=w>            </span><span class=n>root</span><span class=p>.</span><span class=n>children</span><span class=p>[</span><span class=mi>2</span><span class=p>].</span><span class=n>bounds</span><span class=p>.</span><span class=n>min</span><span class=p>.</span><span class=n>x</span><span class=w> </span><span class=o>=</span><span class=w> </span><span class=n>root</span><span class=p>.</span><span class=n>bounds</span><span class=p>.</span><span class=n>center</span><span class=p>().</span><span class=n>x</span><span class=p>;</span><span class=w> </span><span class=c1>// bottom right</span>
</span><span id=__span-11-31><a id=__codelineno-11-31 name=__codelineno-11-31 href=#__codelineno-11-31></a><span class=w>            </span><span class=n>root</span><span class=p>.</span><span class=n>children</span><span class=p>[</span><span class=mi>2</span><span class=p>].</span><span class=n>bounds</span><span class=p>.</span><span class=n>min</span><span class=p>.</span><span class=n>y</span><span class=w> </span><span class=o>=</span><span class=w> </span><span class=n>root</span><span class=p>.</span><span class=n>bounds</span><span class=p>.</span><span class=n>center</span><span class=p>().</span><span class=n>y</span><span class=p>;</span><span class=w> </span><span class=c1>// bottom right</span>
</span><span id=__span-11-32><a id=__codelineno-11-32 name=__codelineno-11-32 href=#__codelineno-11-32></a><span class=w>            </span><span class=n>root</span><span class=p>.</span><span class=n>children</span><span class=p>[</span><span class=mi>3</span><span class=p>].</span><span class=n>bounds</span><span class=p>.</span><span class=n>max</span><span class=p>.</span><span class=n>x</span><span class=w> </span><span class=o>=</span><span class=w> </span><span class=n>root</span><span class=p>.</span><span class=n>bounds</span><span class=p>.</span><span class=n>center</span><span class=p>().</span><span class=n>x</span><span class=p>;</span><span class=w> </span><span class=c1>// bottom left</span>
</span><span id=__span-11-33><a id=__codelineno-11-33 name=__codelineno-11-33 href=#__codelineno-11-33></a><span class=w>            </span><span class=n>root</span><span class=p>.</span><span class=n>children</span><span class=p>[</span><span class=mi>3</span><span class=p>].</span><span class=n>bounds</span><span class=p>.</span><span class=n>min</span><span class=p>.</span><span class=n>y</span><span class=w> </span><span class=o>=</span><span class=w> </span><span class=n>root</span><span class=p>.</span><span class=n>bounds</span><span class=p>.</span><span class=n>center</span><span class=p>().</span><span class=n>y</span><span class=p>;</span><span class=w> </span><span class=c1>// bottom left</span>
</span><span id=__span-11-34><a id=__codelineno-11-34 name=__codelineno-11-34 href=#__codelineno-11-34></a><span class=w>            </span><span class=k>for</span><span class=w> </span><span class=p>(</span><span class=k>auto</span><span class=o>&amp;</span><span class=w> </span><span class=n>data</span><span class=w> </span><span class=o>:</span><span class=w> </span><span class=n>root</span><span class=p>.</span><span class=n>data</span><span class=p>)</span><span class=w> </span><span class=p>{</span>
</span><span id=__span-11-35><a id=__codelineno-11-35 name=__codelineno-11-35 href=#__codelineno-11-35></a><span class=w>                </span><span class=n>insert</span><span class=p>(</span><span class=n>root</span><span class=p>,</span><span class=w> </span><span class=n>data</span><span class=p>);</span>
</span><span id=__span-11-36><a id=__codelineno-11-36 name=__codelineno-11-36 href=#__codelineno-11-36></a><span class=w>            </span><span class=p>}</span>
</span><span id=__span-11-37><a id=__codelineno-11-37 name=__codelineno-11-37 href=#__codelineno-11-37></a><span class=w>            </span><span class=n>root</span><span class=p>.</span><span class=n>data</span><span class=p>.</span><span class=n>clear</span><span class=p>();</span>
</span><span id=__span-11-38><a id=__codelineno-11-38 name=__codelineno-11-38 href=#__codelineno-11-38></a><span class=w>        </span><span class=p>}</span>
</span><span id=__span-11-39><a id=__codelineno-11-39 name=__codelineno-11-39 href=#__codelineno-11-39></a><span class=w>    </span><span class=p>}</span><span class=w> </span><span class=k>else</span><span class=w> </span><span class=p>{</span>
</span><span id=__span-11-40><a id=__codelineno-11-40 name=__codelineno-11-40 href=#__codelineno-11-40></a><span class=w>        </span><span class=k>for</span><span class=w> </span><span class=p>(</span><span class=k>auto</span><span class=o>&amp;</span><span class=w> </span><span class=n>child</span><span class=w> </span><span class=o>:</span><span class=w> </span><span class=n>root</span><span class=p>.</span><span class=n>children</span><span class=p>)</span><span class=w> </span><span class=p>{</span>
</span><span id=__span-11-41><a id=__codelineno-11-41 name=__codelineno-11-41 href=#__codelineno-11-41></a><span class=w>            </span><span class=k>if</span><span class=w> </span><span class=p>(</span><span class=n>child</span><span class=p>.</span><span class=n>bounds</span><span class=p>.</span><span class=n>contains</span><span class=p>(</span><span class=n>data</span><span class=p>.</span><span class=n>center</span><span class=p>))</span><span class=w> </span><span class=p>{</span>
</span><span id=__span-11-42><a id=__codelineno-11-42 name=__codelineno-11-42 href=#__codelineno-11-42></a><span class=w>                </span><span class=n>insert</span><span class=p>(</span><span class=n>child</span><span class=p>,</span><span class=w> </span><span class=n>data</span><span class=p>);</span>
</span><span id=__span-11-43><a id=__codelineno-11-43 name=__codelineno-11-43 href=#__codelineno-11-43></a><span class=w>                </span><span class=k>break</span><span class=p>;</span>
</span><span id=__span-11-44><a id=__codelineno-11-44 name=__codelineno-11-44 href=#__codelineno-11-44></a><span class=w>            </span><span class=p>}</span>
</span><span id=__span-11-45><a id=__codelineno-11-45 name=__codelineno-11-45 href=#__codelineno-11-45></a><span class=w>        </span><span class=p>}</span>
</span><span id=__span-11-46><a id=__codelineno-11-46 name=__codelineno-11-46 href=#__codelineno-11-46></a><span class=w>    </span><span class=p>}</span>
</span><span id=__span-11-47><a id=__codelineno-11-47 name=__codelineno-11-47 href=#__codelineno-11-47></a><span class=p>}</span>
</span><span id=__span-11-48><a id=__codelineno-11-48 name=__codelineno-11-48 href=#__codelineno-11-48></a>
</span><span id=__span-11-49><a id=__codelineno-11-49 name=__codelineno-11-49 href=#__codelineno-11-49></a><span class=c1>// query</span>
</span><span id=__span-11-50><a id=__codelineno-11-50 name=__codelineno-11-50 href=#__codelineno-11-50></a><span class=k>template</span><span class=o>&lt;</span><span class=k>class</span><span class=w> </span><span class=nc>T</span><span class=o>&gt;</span>
</span><span id=__span-11-51><a id=__codelineno-11-51 name=__codelineno-11-51 href=#__codelineno-11-51></a><span class=kt>void</span><span class=w> </span><span class=n>query</span><span class=p>(</span><span class=n>QuadtreeNode</span><span class=o>&lt;</span><span class=n>T</span><span class=o>&gt;&amp;</span><span class=w> </span><span class=n>root</span><span class=p>,</span><span class=w> </span><span class=n>Rectangle2f</span><span class=w> </span><span class=n>bounds</span><span class=p>,</span><span class=w> </span><span class=n>std</span><span class=o>::</span><span class=n>vector</span><span class=o>&lt;</span><span class=n>DataAtPosition</span><span class=o>&lt;</span><span class=n>T</span><span class=o>&gt;&gt;&amp;</span><span class=w> </span><span class=n>result</span><span class=p>)</span><span class=w> </span><span class=p>{</span>
</span><span id=__span-11-52><a id=__codelineno-11-52 name=__codelineno-11-52 href=#__codelineno-11-52></a><span class=w>    </span><span class=k>if</span><span class=w> </span><span class=p>(</span><span class=n>root</span><span class=p>.</span><span class=n>bounds</span><span class=p>.</span><span class=n>intersects</span><span class=p>(</span><span class=n>bounds</span><span class=p>))</span><span class=w> </span><span class=p>{</span>
</span><span id=__span-11-53><a id=__codelineno-11-53 name=__codelineno-11-53 href=#__codelineno-11-53></a><span class=w>        </span><span class=k>for</span><span class=w> </span><span class=p>(</span><span class=k>auto</span><span class=o>&amp;</span><span class=w> </span><span class=n>data</span><span class=w> </span><span class=o>:</span><span class=w> </span><span class=n>root</span><span class=p>.</span><span class=n>data</span><span class=p>)</span><span class=w> </span><span class=p>{</span>
</span><span id=__span-11-54><a id=__codelineno-11-54 name=__codelineno-11-54 href=#__codelineno-11-54></a><span class=w>            </span><span class=k>if</span><span class=w> </span><span class=p>(</span><span class=n>bounds</span><span class=p>.</span><span class=n>contains</span><span class=p>(</span><span class=n>data</span><span class=p>.</span><span class=n>center</span><span class=p>))</span><span class=w> </span><span class=p>{</span>
</span><span id=__span-11-55><a id=__codelineno-11-55 name=__codelineno-11-55 href=#__codelineno-11-55></a><span class=w>                </span><span class=n>result</span><span class=p>.</span><span class=n>push_back</span><span class=p>(</span><span class=n>data</span><span class=p>);</span>
</span><span id=__span-11-56><a id=__codelineno-11-56 name=__codelineno-11-56 href=#__codelineno-11-56></a><span class=w>            </span><span class=p>}</span>
</span><span id=__span-11-57><a id=__codelineno-11-57 name=__codelineno-11-57 href=#__codelineno-11-57></a><span class=w>        </span><span class=p>}</span>
</span><span id=__span-11-58><a id=__codelineno-11-58 name=__codelineno-11-58 href=#__codelineno-11-58></a><span class=w>        </span><span class=k>for</span><span class=w> </span><span class=p>(</span><span class=k>auto</span><span class=o>&amp;</span><span class=w> </span><span class=n>child</span><span class=w> </span><span class=o>:</span><span class=w> </span><span class=n>root</span><span class=p>.</span><span class=n>children</span><span class=p>)</span><span class=w> </span><span class=p>{</span>
</span><span id=__span-11-59><a id=__codelineno-11-59 name=__codelineno-11-59 href=#__codelineno-11-59></a><span class=w>            </span><span class=n>query</span><span class=p>(</span><span class=n>child</span><span class=p>,</span><span class=w> </span><span class=n>bounds</span><span class=p>,</span><span class=w> </span><span class=n>result</span><span class=p>);</span>
</span><span id=__span-11-60><a id=__codelineno-11-60 name=__codelineno-11-60 href=#__codelineno-11-60></a><span class=w>        </span><span class=p>}</span>
</span><span id=__span-11-61><a id=__codelineno-11-61 name=__codelineno-11-61 href=#__codelineno-11-61></a><span class=w>    </span><span class=p>}</span>
</span><span id=__span-11-62><a id=__codelineno-11-62 name=__codelineno-11-62 href=#__codelineno-11-62></a><span class=p>}</span>
</span></code></pre></div> <h2 id=quadtree-optimization>Quadtree optimization<a class=headerlink href=#quadtree-optimization title="Permanent link">&para;</a></h2> <p>The quadtree is a recursive data structure, so it is not cache friendly. You can optimize it by using a flat array instead of a recursive data structure. </p> <h1 id=octree>Octree<a class=headerlink href=#octree title="Permanent link">&para;</a></h1> <p>Section WiP. Send a merge request if you want to contribute.</p> <h1 id=kd-tree>KD-Tree<a class=headerlink href=#kd-tree title="Permanent link">&para;</a></h1> <p>KD-Trees are a tree data structure that are used to partition a spaces in any dimension (2D, 3D, 4D, etc). They are used to optimize collision detection(Physics), pathfinding(AI), and other algorithms that need to iterate over a space. Also they are also used to optimize rendering, because you can render only the visible part of the space. Pay attention that KD-Trees are not the same as Quadtree and Octrees, even if they are similar.</p> <p>In KD-trees, every node defines an orthogonal partition plan that alternate every deepening level of the tree. The partition plan is defined by a dimension, a value. The dimension is the axis that is used to partition the space, and the value is the position of the partition plan. The partition plan is orthogonal to the axis, so it is a line in 2D, a plane in 3D, and a hyperplane in 4D.</p> <h1 id=bsp-tree>BSP Tree<a class=headerlink href=#bsp-tree title="Permanent link">&para;</a></h1> <p>BSP inherits almost all characteristics of KD-Trees, but it is not a tree data structure, it is a graph data structure. The main difference is to instead of being orthogonal you define the plane of the section. The plane is defined by a point and a normal. The normal is the direction of the plane, and the point is a point in the plane. </p> <h1 id=spatial-hashing>Spatial Hashing<a class=headerlink href=#spatial-hashing title="Permanent link">&para;</a></h1> <p>Spatial hashing is a data structure that is used to partition a space. It consists in a hash table where the keys are the positions of the elements, and the values are the elements in buckets. It is very fast to insert and query elements. But it is not good for iteration, because it is not cache friendly.</p> <p>Usually when you want to use a spatial hashing, you create hash functions for the bucket keys, there is no limit on how you do that, but you have to keep in mind that the hash functions have to be fast and have to be good for the distribution of the elements. Here is a good example of a hashing function for 2D vectors.</p> <div class="language-c++ highlight"><pre><span></span><code><span id=__span-12-1><a id=__codelineno-12-1 name=__codelineno-12-1 href=#__codelineno-12-1></a><span class=k>namespace</span><span class=w> </span><span class=nn>std</span><span class=w> </span><span class=p>{</span>
</span><span id=__span-12-2><a id=__codelineno-12-2 name=__codelineno-12-2 href=#__codelineno-12-2></a><span class=w>    </span><span class=k>template</span><span class=o>&lt;&gt;</span>
</span><span id=__span-12-3><a id=__codelineno-12-3 name=__codelineno-12-3 href=#__codelineno-12-3></a><span class=w>    </span><span class=k>struct</span><span class=w> </span><span class=nc>hash</span><span class=o>&lt;</span><span class=n>Vector2f</span><span class=o>&gt;</span><span class=w> </span><span class=p>{</span>
</span><span id=__span-12-4><a id=__codelineno-12-4 name=__codelineno-12-4 href=#__codelineno-12-4></a><span class=w>        </span><span class=c1>// I am assuming size_t is 64 bits and the float is 32 bits</span>
</span><span id=__span-12-5><a id=__codelineno-12-5 name=__codelineno-12-5 href=#__codelineno-12-5></a><span class=w>        </span><span class=kt>size_t</span><span class=w> </span><span class=nf>operator</span><span class=p>()(</span><span class=k>const</span><span class=w> </span><span class=n>Vector2f</span><span class=o>&amp;</span><span class=w> </span><span class=n>v</span><span class=p>)</span><span class=w> </span><span class=k>const</span><span class=w> </span><span class=p>{</span>
</span><span id=__span-12-6><a id=__codelineno-12-6 name=__codelineno-12-6 href=#__codelineno-12-6></a><span class=w>            </span><span class=c1>// get the bits of the float in a integer</span>
</span><span id=__span-12-7><a id=__codelineno-12-7 name=__codelineno-12-7 href=#__codelineno-12-7></a><span class=w>            </span><span class=kt>uint64_t</span><span class=w> </span><span class=n>x</span><span class=w> </span><span class=o>=</span><span class=w> </span><span class=o>*</span><span class=p>(</span><span class=kt>uint64_t</span><span class=o>*</span><span class=p>)</span><span class=o>&amp;</span><span class=n>v</span><span class=p>.</span><span class=n>x</span><span class=p>;</span>
</span><span id=__span-12-8><a id=__codelineno-12-8 name=__codelineno-12-8 href=#__codelineno-12-8></a><span class=w>            </span><span class=kt>uint64_t</span><span class=w> </span><span class=n>y</span><span class=w> </span><span class=o>=</span><span class=w> </span><span class=o>*</span><span class=p>(</span><span class=kt>uint64_t</span><span class=o>*</span><span class=p>)</span><span class=o>&amp;</span><span class=n>v</span><span class=p>.</span><span class=n>y</span><span class=p>;</span>
</span><span id=__span-12-9><a id=__codelineno-12-9 name=__codelineno-12-9 href=#__codelineno-12-9></a><span class=w>            </span><span class=c1>// mix the bits of the floats</span>
</span><span id=__span-12-10><a id=__codelineno-12-10 name=__codelineno-12-10 href=#__codelineno-12-10></a><span class=w>            </span><span class=kt>uint64_t</span><span class=w> </span><span class=n>hash</span><span class=w> </span><span class=o>=</span><span class=w> </span><span class=n>x</span><span class=w> </span><span class=o>|</span><span class=w> </span><span class=p>(</span><span class=n>y</span><span class=w> </span><span class=o>&lt;&lt;</span><span class=w> </span><span class=mi>32</span><span class=p>);</span>
</span><span id=__span-12-11><a id=__codelineno-12-11 name=__codelineno-12-11 href=#__codelineno-12-11></a><span class=w>            </span><span class=k>return</span><span class=w> </span><span class=n>hash</span><span class=p>;</span>
</span><span id=__span-12-12><a id=__codelineno-12-12 name=__codelineno-12-12 href=#__codelineno-12-12></a><span class=w>        </span><span class=p>}</span>
</span><span id=__span-12-13><a id=__codelineno-12-13 name=__codelineno-12-13 href=#__codelineno-12-13></a><span class=w>    </span><span class=p>};</span>
</span><span id=__span-12-14><a id=__codelineno-12-14 name=__codelineno-12-14 href=#__codelineno-12-14></a><span class=p>}</span>
</span></code></pre></div> <p>Pay attention that the hashing function above generates collisions, so you have to use a data structure that can handle collisions. You will use datastructures like <code>unordered_map&lt;Vector2D, unordered_set&lt;DATATYPE&gt;&gt;</code> or <code>unordered_map&lt;Vector2D, vector&lt;DATATYPE&gt;&gt;</code>. The first one is better for insertion and query, but it is not cache friendly. </p> <p>To avoid having one bucket per every possible position, you have to setup properly the dimension of the bucket, a good sugestion is to alwoys floor the position and have buckets dimension of 1.0f. That would be good enough for most cases.</p> <aside class=md-source-file> <span class=md-source-file__fact> <span class=md-icon title="Last update"> <svg xmlns=http://www.w3.org/2000/svg viewbox="0 0 24 24"><path d="M21 13.1c-.1 0-.3.1-.4.2l-1 1 2.1 2.1 1-1c.2-.2.2-.6 0-.8l-1.3-1.3c-.1-.1-.2-.2-.4-.2m-1.9 1.8-6.1 6V23h2.1l6.1-6.1zM12.5 7v5.2l4 2.4-1 1L11 13V7zM11 21.9c-5.1-.5-9-4.8-9-9.9C2 6.5 6.5 2 12 2c5.3 0 9.6 4.1 10 9.3-.3-.1-.6-.2-1-.2s-.7.1-1 .2C19.6 7.2 16.2 4 12 4c-4.4 0-8 3.6-8 8 0 4.1 3.1 7.5 7.1 7.9l-.1.2z"/></svg> </span> <span class="git-revision-date-localized-plugin git-revision-date-localized-plugin-date">October 14, 2023</span> </span> <span class=md-source-file__fact> <span class=md-icon title=Created> <svg xmlns=http://www.w3.org/2000/svg viewbox="0 0 24 24"><path d="M14.47 15.08 11 13V7h1.5v5.25l3.08 1.83c-.41.28-.79.62-1.11 1m-1.39 4.84c-.36.05-.71.08-1.08.08-4.42 0-8-3.58-8-8s3.58-8 8-8 8 3.58 8 8c0 .37-.03.72-.08 1.08.69.1 1.33.32 1.92.64.1-.56.16-1.13.16-1.72 0-5.5-4.5-10-10-10S2 6.5 2 12s4.47 10 10 10c.59 0 1.16-.06 1.72-.16-.32-.59-.54-1.23-.64-1.92M18 15v3h-3v2h3v3h2v-3h3v-2h-3v-3z"/></svg> </span> <span class="git-revision-date-localized-plugin git-revision-date-localized-plugin-date">January 18, 2023</span> </span> <span class=md-source-file__fact> <span class=md-icon title=Contributors> <svg xmlns=http://www.w3.org/2000/svg viewbox="0 0 24 24"><path d="M12 2A10 10 0 0 0 2 12c0 4.42 2.87 8.17 6.84 9.5.5.08.66-.23.66-.5v-1.69c-2.77.6-3.36-1.34-3.36-1.34-.46-1.16-1.11-1.47-1.11-1.47-.91-.62.07-.6.07-.6 1 .07 1.53 1.03 1.53 1.03.87 1.52 2.34 1.07 2.91.83.09-.65.35-1.09.63-1.34-2.22-.25-4.55-1.11-4.55-4.92 0-1.11.38-2 1.03-2.71-.1-.25-.45-1.29.1-2.64 0 0 .84-.27 2.75 1.02.79-.22 1.65-.33 2.5-.33s1.71.11 2.5.33c1.91-1.29 2.75-1.02 2.75-1.02.55 1.35.2 2.39.1 2.64.65.71 1.03 1.6 1.03 2.71 0 3.82-2.34 4.66-4.57 4.91.36.31.69.92.69 1.85V21c0 .27.16.59.67.5C19.14 20.16 22 16.42 22 12A10 10 0 0 0 12 2"/></svg> </span> <span>GitHub</span> <nav> <a href=https://github.com/tolstenko class=md-author title=@tolstenko> <img src="https://avatars.githubusercontent.com/u/2386417?v=4&size=72" alt=tolstenko> </a> </nav> </span> </aside> </article> </div> <script>var target=document.getElementById(location.hash.slice(1));target&&target.name&&(target.checked=target.name.startsWith("__tabbed_"))</script> </div> <button type=button class="md-top md-icon" data-md-component=top hidden> <svg xmlns=http://www.w3.org/2000/svg viewbox="0 0 24 24"><path d="M13 20h-2V8l-5.5 5.5-1.42-1.42L12 4.16l7.92 7.92-1.42 1.42L13 8z"/></svg> Back to top </button> </main> <footer class=md-footer> <nav class="md-footer__inner md-grid" aria-label=Footer> <a href=../../ class="md-footer__link md-footer__link--prev" aria-label="Previous: Artificial Intelligence"> <div class="md-footer__button md-icon"> <svg xmlns=http://www.w3.org/2000/svg viewbox="0 0 24 24"><path d="M20 11v2H8l5.5 5.5-1.42 1.42L4.16 12l7.92-7.92L13.5 5.5 8 11z"/></svg> </div> <div class=md-footer__title> <span class=md-footer__direction> Previous </span> <div class=md-ellipsis> Artificial Intelligence </div> </div> </a> <a href=../../04-spatialhashing/ class="md-footer__link md-footer__link--next" aria-label="Next: Spatial Hashing"> <div class=md-footer__title> <span class=md-footer__direction> Next </span> <div class=md-ellipsis> Spatial Hashing </div> </div> <div class="md-footer__button md-icon"> <svg xmlns=http://www.w3.org/2000/svg viewbox="0 0 24 24"><path d="M4 11v2h12l-5.5 5.5 1.42 1.42L19.84 12l-7.92-7.92L10.5 5.5 16 11z"/></svg> </div> </a> </nav> <div class="md-footer-meta md-typeset"> <div class="md-footer-meta__inner md-grid"> <div class=md-copyright> <div class=md-copyright__highlight> Copyright &copy; 2024 Tolstenko, Game Guild Community and Others </div> </div> </div> </div> </footer> </div> <div class=md-dialog data-md-component=dialog> <div class="md-dialog__inner md-typeset"></div> </div> <div class=md-consent data-md-component=consent id=__consent hidden> <div class=md-consent__overlay></div> <aside class=md-consent__inner> <form class="md-consent__form md-grid md-typeset" name=consent> <h4></h4> <p>This site uses cookies to provide you with a better user experience. By using this site you consent to our use of cookies.</p> <input class=md-toggle type=checkbox id=__settings> <div class=md-consent__settings> <ul class=task-list> <li class=task-list-item> <label class=task-list-control> <input type=checkbox name=smartlook checked> <span class=task-list-indicator></span> SmartLook </label> </li> <li class=task-list-item> <label class=task-list-control> <input type=checkbox name=analytics checked> <span class=task-list-indicator></span> Google Analytics </label> </li> <li class=task-list-item> <label class=task-list-control> <input type=checkbox name=github checked> <span class=task-list-indicator></span> GitHub </label> </li> </ul> </div> <div class=md-consent__controls> <button class="md-button md-button--primary">Accept</button> <label class=md-button for=__settings>Manage settings</label> </div> </form> </aside> </div> <script>var consent=__md_get("__consent");if(consent)for(var input of document.forms.consent.elements)input.name&&(input.checked=consent[input.name]||!1);else"file:"!==location.protocol&&setTimeout((function(){document.querySelector("[data-md-component=consent]").hidden=!1}),250);var form=document.forms.consent;for(var action of["submit","reset"])form.addEventListener(action,(function(e){if(e.preventDefault(),"reset"===e.type)for(var n of document.forms.consent.elements)n.name&&(n.checked=!1);__md_set("__consent",Object.fromEntries(Array.from(new FormData(form).keys()).map((function(e){return[e,!0]})))),location.hash="",location.reload()}))</script> <script id=__config type=application/json>{"annotate": {"json": [".s2"]}, "base": "../../..", "features": ["attr_list", "md_in_html", "pymdownx.superfences", "announce.dismiss", "content.action.edit", "content.code.annotate", "content.code.copy", "content.code.select", "content.tooltips", "navigation.footer", "navigation.indexes", "navigation.prune", "navigation.tabs", "navigation.top", "navigation.tracking", "navigation.path", "search.highlight", "search.share", "search.suggest", "toc.follow", "toc.integrate"], "search": "../../../assets/javascripts/workers/search.c7c1ca2c.min.js", "translations": {"clipboard.copied": "Copied to clipboard", "clipboard.copy": "Copy to clipboard", "search.result.more.one": "1 more on this page", "search.result.more.other": "# more on this page", "search.result.none": "No matching documents", "search.result.one": "1 matching document", "search.result.other": "# matching documents", "search.result.placeholder": "Type to start searching", "search.result.term.missing": "Missing", "select.version": "Select version"}}</script> <script src=../../../assets/javascripts/bundle.203fd0bc.min.js></script> <script src=../../../js/mkdocs-charts-plugin.js></script> <script src=../../../javascripts/mathjax.js></script> <script src="https://polyfill.io/v3/polyfill.min.js?features=es6"></script> <script src=https://cdn.jsdelivr.net/npm/mathjax@3/es5/tex-mml-chtml.js></script> <script src=https://cdn.jsdelivr.net/npm/vega@5></script> <script src=https://cdn.jsdelivr.net/npm/vega-lite@5></script> <script src=https://cdn.jsdelivr.net/npm/vega-embed@6></script> <script id="init-glightbox">const lightbox = GLightbox({"touchNavigation": true, "loop": false, "zoomable": true, "draggable": true, "openEffect": "zoom", "closeEffect": "zoom", "slideEffect": "slide"});
document$.subscribe(() => { lightbox.reload() });
</script></body> </html>